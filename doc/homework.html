<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Youjie_Zeng_20088" />


<title>StatCompHomwork_20088</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">StatCompHomwork_20088</h1>
<h4 class="author">Youjie_Zeng_20088</h4>
<h4 class="date">2020/12/15</h4>



<hr />
<div id="all-homework-of-statcomp-fall-term2020-by-youjie-zeng-id-20088" class="section level2">
<h2>All homework of StatComp (Fall term,2020) by Youjie Zeng (ID: 20088)</h2>
<p>This is an R Markdown document which includes all of the homework during the author studying the lesson, Statistical Computing (lecturer: Prof.Zhang, Fall,2020).</p>
</div>
<div id="section" class="section level2">
<h2>2020/9/28</h2>
</div>
<div id="example-1." class="section level2">
<h2>Example 1.</h2>
<p>Create an example containing text and at least one figure.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>This is a picture of panda.</p>
</div>
<div id="example-2." class="section level2">
<h2>Example 2.</h2>
<p>Create an example containing texts and at least one table.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>This is a table of grades in USTC.</p>
<pre><code>## Warning: 程辑包&#39;kableExtra&#39;是用R版本4.0.3 来建造的</code></pre>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
Class
</th>
<th style="text-align:right;">
GPA
</th>
<th style="text-align:left;">
grade
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A+
</td>
<td style="text-align:right;">
4.3
</td>
<td style="text-align:left;">
100~95
</td>
</tr>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
4.0
</td>
<td style="text-align:left;">
94~90
</td>
</tr>
<tr>
<td style="text-align:left;">
A-
</td>
<td style="text-align:right;">
3.7
</td>
<td style="text-align:left;">
89~85
</td>
</tr>
<tr>
<td style="text-align:left;">
B+
</td>
<td style="text-align:right;">
3.3
</td>
<td style="text-align:left;">
84~82
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:left;">
81~78
</td>
</tr>
<tr>
<td style="text-align:left;">
B-
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:left;">
77~75
</td>
</tr>
<tr>
<td style="text-align:left;">
C+
</td>
<td style="text-align:right;">
2.3
</td>
<td style="text-align:left;">
74~72
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
2.0
</td>
<td style="text-align:left;">
71~68
</td>
</tr>
<tr>
<td style="text-align:left;">
C-
</td>
<td style="text-align:right;">
1.7
</td>
<td style="text-align:left;">
67~65
</td>
</tr>
<tr>
<td style="text-align:left;">
D+
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:left;">
64
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:left;">
63~61
</td>
</tr>
<tr>
<td style="text-align:left;">
D-
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:left;">
60
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:left;">
&lt;60
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3." class="section level2">
<h2>Example 3.</h2>
<p>Create an example containing at least a couple of LaTeX formulas.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>Maxwell’s equations <span class="math display">\[\begin{align*}
\nabla \times \boldsymbol{H} &amp;= \boldsymbol{J} + \frac{\partial \boldsymbol{D}}{\partial t},\\
\nabla \times \boldsymbol{E} &amp;= -\frac{\partial \boldsymbol{B}}{\partial t},\\
\nabla \cdot \boldsymbol{B} &amp;= 0,\\
\nabla \cdot \boldsymbol{D} &amp;= 0.
\end{align*}\]</span></p>
</div>
<div id="section-1" class="section level2">
<h2>2020/9/29</h2>
</div>
<div id="ex-3.3" class="section level2">
<h2>Ex 3.3</h2>
<p>The Pareto(a, b) distribution has cdf <span class="math display">\[ F(x) = 1 - \left(\frac{b}{x}\right)^a, x \geq b&gt;0, a &gt; 0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution. Graph the density histogram of the sample with the Pareto(2, 2) density superimposed for comparison</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<p>The inverse transformation is <span class="math inline">\(X = F^{-1}(U) = b(1-U)^{-1/a}\)</span>. The density is <span class="math inline">\(f(x)=ab^a \left(\frac{1}{x}\right)^{a+1}\)</span>. We generate 1000 samples from the uniform distribution <span class="math inline">\(U(0,1)\)</span> and use the inverse transformation to obtain the coresponding samples from the distribution Pareto(2,2) as the follow.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>a &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>b &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb2-6"><a href="#cb2-6"></a>x &lt;-<span class="st"> </span>b<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span>a)</span>
<span id="cb2-7"><a href="#cb2-7"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) fx &lt;-<span class="st"> </span><span class="dv">8</span><span class="op">/</span>(x<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="kw">length</span>(x)<span class="op">/</span><span class="dv">10</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">8</span><span class="op">/</span>(x<span class="op">^</span><span class="dv">3</span>)))</span>
<span id="cb2-9"><a href="#cb2-9"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>,<span class="kw">max</span>(x),<span class="fl">0.1</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="kw">lines</span>(y,<span class="kw">f</span>(y))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="ex-3.9" class="section level2">
<h2>Ex 3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[ f_e ( x) = \frac{3}{4} (1-x^2), |x|\leq 1 .\]</span> Devroye and Gy<span class="math inline">\(\ddot{\text{o}}\)</span>rfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_1, U_2, U_3 \sim Uniform(-1,1)\)</span>. If <span class="math inline">\(|U_3| \geq |U_2|\)</span> and <span class="math inline">\(|U_3| \geq |U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The procedure is shown as follow:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>deliver &lt;-<span class="st"> </span><span class="cf">function</span>(x,y,z){</span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(z)<span class="op">&gt;=</span><span class="kw">abs</span>(y)<span class="op">&amp;</span><span class="kw">abs</span>(z)<span class="op">&gt;=</span><span class="kw">abs</span>(x)) <span class="kw">return</span>(y)</span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="cf">else</span> <span class="kw">return</span>(z)</span>
<span id="cb3-4"><a href="#cb3-4"></a>} <span class="co"># choose u from u1,u2,u3</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>f_e &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="fl">0.75</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-7"><a href="#cb3-7"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a>u2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb3-10"><a href="#cb3-10"></a>u3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dt">min =</span> <span class="dv">-1</span>,<span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a>u &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb3-13"><a href="#cb3-13"></a>  u[i]&lt;-<span class="st"> </span><span class="kw">deliver</span>(u1[i],u2[i],u3[i])</span>
<span id="cb3-14"><a href="#cb3-14"></a>}</span>
<span id="cb3-15"><a href="#cb3-15"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="kw">hist</span>(u,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span><span class="dv">3</span><span class="op">/</span><span class="dv">4</span> (<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw">lines</span>(x,<span class="kw">f_e</span>(x))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="ex-3.10" class="section level2">
<h2>Ex 3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_e\)</span> (3.10).</p>
</div>
<div id="proof" class="section level2">
<h2>Proof</h2>
<p>It is obvious that <span class="math inline">\(|U_1|,|U_2|,|U_3| i.i.d \sim U(-1,1)\)</span>. Let <span class="math inline">\(U\)</span> be the generated variate, and <span class="math inline">\(U\)</span> has a symmetric distribution on interval <span class="math inline">\((-1,1)\)</span>. We shall consider <span class="math inline">\(|U|\)</span> first, then conduct the result from the distribution of <span class="math inline">\(|U|\)</span> on <span class="math inline">\((0,1)\)</span> through its symmetry. Let <span class="math inline">\(X,Y,Z i.i.d \sim U(0,1)\)</span>, if <span class="math inline">\(Z\geq Y, Z\geq X\)</span>,then <span class="math inline">\(W = Y\)</span>; otherwise, <span class="math inline">\(W = Z\)</span>. We conduct the distribution of <span class="math inline">\(W\)</span>.</p>
<p>Since the symmetry, <span class="math inline">\(W=Y\)</span> and <span class="math inline">\(W=X\)</span> are equivalent when <span class="math inline">\(Z\geq Y, Z\geq X\)</span>. When <span class="math inline">\(Z&lt;Y\)</span> or <span class="math inline">\(Z&lt;X\)</span>, <span class="math inline">\(W=Z\)</span> means that <span class="math inline">\(W&lt;X,W&lt;Y\)</span>. In general, <span class="math inline">\(W\)</span> is always one of the two smallest of <span class="math inline">\(X,Y,Z\)</span>.</p>
<p>Consider the event <span class="math inline">\(\{W \leq t\}, t\in (0,1)\)</span>, and there must exist at least one of <span class="math inline">\(X,Y,Z\)</span> lie in (0,t). We discuss it in the two ways:</p>
<ol style="list-style-type: decimal">
<li><p>There exactly exists one of <span class="math inline">\(X,Y,Z\)</span> that lies in (0,t), and we obtain <span class="math inline">\(\{W\leq t\}\)</span> with probablity <span class="math inline">\(\frac{1}{2}\)</span>, then the coresponding probablity is <span class="math display">\[\left(
\begin{array}{c}
3\\
1
\end{array}
\right) t(1-t)^2 \times \frac{1}{2} = \frac{3}{2} t(1-t)^2.\]</span></p></li>
<li><p>There exist at least two of <span class="math inline">\(X,Y,Z\)</span> lie in <span class="math inline">\((0,t)\)</span>, then the coresponding probablity is</p></li>
</ol>
<p><span class="math display">\[\left(
\begin{array}{c}
3\\
2
\end{array}
\right) t^2(1-t) 
+ 
\left(
\begin{array}{c}
3\\
3
\end{array}
\right) t^3 = t^2 (3-2t)\]</span></p>
<p>Then, he cdf of <span class="math inline">\(Z=|U|\)</span> is <span class="math display">\[ F_Z (t)= P(W\leq t) = \frac{3}{2} t(1-t)^2 + t^2 (3-2t) = \frac{3}{2} t - \frac{t^3}{2}.\]</span> Last, we conduct the cdf of <span class="math inline">\(U\)</span> through its symmetry. Define <span class="math display">\[U=\left\{ \begin{array}{c}
Z, \ \ p=\frac{1}{2} \\
-Z, \ \ p = \frac{1}{2}
\end{array}
\right.
\]</span> Then the cdf of <span class="math inline">\(U\)</span> is <span class="math display">\[F_U (u)=\left\{ \begin{array}{c}
\frac{1}{2} + \frac{1}{2} F_Z(u), \ \ u \geq 0, \\
\frac{1}{2} (1-F_Z(-u)), \ \ u&lt;0.
\end{array}
\right.
\]</span> Therefore, the density of <span class="math inline">\(U\)</span> is <span class="math display">\[F&#39;(u) = \frac{1}{2} F&#39;_Z(u) = \frac{3}{4}(1-u^2) = f_e (u).\]</span> That is the result we want.</p>
</div>
<div id="ex-3.13" class="section level2">
<h2>Ex 3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[ F(y) = 1 - \left( \frac{\beta}{\beta + y}\right)^r, y \geq 0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 1000 random observations from the mixture with <span class="math inline">\(r = 4\)</span> and <span class="math inline">\(\beta = 2\)</span>. Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li><p>For <span class="math inline">\(y\geq 0\)</span>, <span class="math display">\[\begin{align}
F(y) = P(Y\leq y) &amp;= \int_0^\infty P(Y\leq y | \Lambda = \lambda) f_G(\lambda) d \lambda\\
&amp;=\int_0^\infty \left(1-e^{-\lambda y}\right) \frac{\beta^\gamma \lambda^{\gamma - 1} e^{-\beta \lambda}}{\Gamma(\gamma)} \\
&amp;= 1 - \frac{\beta^\gamma }{\Gamma(\gamma)} \int_0^\infty \lambda^{\gamma - 1} e^{-(\beta + y)\lambda} d\lambda \\
&amp;= 1- \frac{\beta^\gamma }{\Gamma(\gamma)} \frac{\Gamma(\gamma)}{(\beta+y)^\gamma } \\
&amp;= 1- \left(\frac{\beta}{\beta + y}\right)^\gamma
\end{align}\]</span> That is exactly a pareto distribution cdf.</p></li>
<li><p>With <span class="math inline">\(\gamma = 4\)</span> and <span class="math inline">\(\beta=2\)</span>, the density is <span class="math display">\[ f(y) = \frac{64 }{(2 + y)^{5}}.\]</span> We compare the empirical and theoretical (Pareto) distributions as follow.</p></li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">313</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>r &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>beta &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n,r,beta)</span>
<span id="cb4-6"><a href="#cb4-6"></a>x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,lambda)</span>
<span id="cb4-7"><a href="#cb4-7"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="kw">max</span>(x),<span class="dt">length.out =</span> n)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">100</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(y)<span class="op">==</span><span class="dv">64</span><span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>))</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">lines</span>(y,<span class="dv">64</span><span class="op">/</span>(<span class="dv">2</span><span class="op">+</span>y)<span class="op">^</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>2020/9/29</h2>
</div>
<div id="ex-5.1" class="section level2">
<h2>Ex 5.1</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[ \int_0^{\frac{\pi}{3}} sin t\ \  dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math inline">\(X \sim U(0,\pi/3)\)</span>, then <span class="math display">\[\int_0^{\frac{\pi}{3}} sin t\ \  dt = \frac{\pi}{3}\int_0^{\frac{\pi}{3}} sint \frac{3}{\pi} d t  = \frac{\pi}{3} E[sin(X)].\]</span> Using MC, we have</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">set.seed</span>(<span class="dv">51</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(m, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)) <span class="op">*</span><span class="st"> </span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] 0.4993902 0.5000000</code></pre>
</div>
<div id="section-3" class="section level2">
<h2>5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>Consider <span class="math inline">\(U_1 \sim U(0,1)\)</span>, then <span class="math inline">\(E[e^{U_1}] = \theta\)</span>, i.e. <span class="math inline">\(e^{U_1}\)</span> is an unbiased estimator of <span class="math inline">\(\theta\)</span>. Similarly, <span class="math inline">\(U_2 = 1 - U_1 \sim U(0,1)\)</span> and <span class="math inline">\(E[e^{U_2}]\)</span> is an unbiased estimator of <span class="math inline">\(\theta\)</span>. Use antithetic variate approach to estimate <span class="math inline">\(\theta\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">set.seed</span>(<span class="dv">57</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># Antithetic variate approach function</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>AV.appro &lt;-<span class="st"> </span><span class="cf">function</span>(R){</span>
<span id="cb7-5"><a href="#cb7-5"></a>  u1 &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>  u2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>u1</span>
<span id="cb7-7"><a href="#cb7-7"></a>  u &lt;-<span class="st"> </span><span class="kw">c</span>(u1,u2)</span>
<span id="cb7-8"><a href="#cb7-8"></a>  theta.hat.a &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(u))</span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="kw">return</span>(theta.hat.a)</span>
<span id="cb7-10"><a href="#cb7-10"></a>}</span>
<span id="cb7-11"><a href="#cb7-11"></a></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co"># simple MC</span></span>
<span id="cb7-13"><a href="#cb7-13"></a>simpleMC &lt;-<span class="st"> </span><span class="cf">function</span>(R){</span>
<span id="cb7-14"><a href="#cb7-14"></a>  x &lt;-<span class="st"> </span><span class="kw">runif</span>(R,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb7-15"><a href="#cb7-15"></a>  theta.hat.s &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(x))</span>
<span id="cb7-16"><a href="#cb7-16"></a>  <span class="kw">return</span>(theta.hat.s)</span>
<span id="cb7-17"><a href="#cb7-17"></a>}</span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co"># the coresponding estimators</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">AV.appro</span>(m),<span class="kw">simpleMC</span>(m),<span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>))</span></code></pre></div>
<pre><code>## [1] 1.719967 1.713935 1.718282</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># compare sd</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>n &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>MC1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb9-4"><a href="#cb9-4"></a>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb9-7"><a href="#cb9-7"></a>  MC1[i] &lt;-<span class="st"> </span><span class="kw">AV.appro</span>(m)</span>
<span id="cb9-8"><a href="#cb9-8"></a>  MC2[i] &lt;-<span class="st"> </span><span class="kw">simpleMC</span>(m)</span>
<span id="cb9-9"><a href="#cb9-9"></a>}</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),<span class="kw">sd</span>(MC1)<span class="op">/</span><span class="kw">sd</span>(MC2),<span class="dv">1</span><span class="op">-</span><span class="kw">sd</span>(MC1)<span class="op">/</span><span class="kw">sd</span>(MC2)))</span></code></pre></div>
<pre><code>## [1] 0.0008813438 0.0050724198 0.1737521362 0.8262478638</code></pre>
<p>The above result shows the reduction in variance. Last, we will compare it with the theorical results from Ex 5.6: let <span class="math inline">\(U \sim U(0,1)\)</span>,</p>
<p><span class="math display">\[Cov(e^U,e^{1-U}) = E[e^U\cdot e^{1-U}] - E[e^U]\cdot E[e^{1-U}] = e - \theta^2.\]</span> <span class="math display">\[\begin{align}
  Var(e^U + e^{1-U}) &amp;= Var(e^U) + Var(e^{1-U}) + Cov(e^U,e^{1-U})\\
  &amp;= \int_0^1 e^{2u} du - \theta^2 + \int_0^1 e^{2-2u} du - \theta^2 +2e - 2\theta^2\\
  &amp;= (e^2-1) + 2e -4(e-1)^2\\
  &amp;= 0.01564999\\
  Var(\frac{e^{U} + e^{1-U}}{2}) &amp;= \frac{1}{4}Var(e^U + e^{1-U}) = 0.003912497\\
  Var(e^{U}) &amp;= 0.2420356
\end{align}\]</span> <span class="math display">\[\text{percent redunction of variance} = 1 - \frac{Var(\frac{e^U + e^{1-U}}{2})}{Var(e^{U})}= 0.983835\]</span> <span class="math display">\[\text{percent redunction of sd} = 1 - \left(\frac{Var(\frac{e^U + e^{1-U}}{2})}{Var(e^{U})}\right)^{\frac{1}{2}}= 0.8728585\]</span> As above, the simulated reduction of sd (0.8262478638) is close to the theorical result (0.8728585).</p>
</div>
<div id="section-4" class="section level2">
<h2>5.11</h2>
<p>If <span class="math inline">\(\widehat{\theta}_1\)</span> and <span class="math inline">\(\widehat{\theta}_2\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>, and <span class="math inline">\(\widehat{\theta}_1\)</span> and <span class="math inline">\(\widehat{\theta}_2\)</span> are antithetic, we derived that <span class="math inline">\(c^* = 1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\widehat{\theta}_c = c\widehat{\theta}_1 + (1-c)\widehat{\theta}_2\)</span>. Derive <span class="math inline">\(c^*\)</span> for the general case. That is, if <span class="math inline">\(\widehat{\theta}_1\)</span> and <span class="math inline">\(\widehat{\theta}_2\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^*\)</span> that minimizes the variance of the estimator <span class="math inline">\(\widehat{\theta}_c = c\widehat{\theta}_1 + (1-c)\widehat{\theta}_2\)</span> in equation (5.11).(<span class="math inline">\(c^*\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math inline">\(p=Var(\widehat{\theta}_1),q=Var(\widehat{\theta}_2)\)</span> and <span class="math inline">\(r=Cov(\widehat{\theta}_1,\widehat{\theta}_2)\)</span>. Then <span class="math display">\[\begin{align}
  f(c) = Var(\widehat{\theta}_c) &amp;= c^2 Var(\widehat{\theta}_1) + (1-c)^2 Var(\widehat{\theta}_2) + 2c(1-c) Cov (\widehat{\theta}_1,\widehat{\theta}_2)\\
  &amp; = pc^2 + q(1-c)^2 + 2rc(1-c)\\
  &amp;= (p+q - 2r) c^2 + 2(r-q)c +q
\end{align}\]</span> Since <span class="math inline">\(p + q - 2r &gt;0\)</span> and <span class="math inline">\(\Delta &lt; 0\)</span>, <span class="math inline">\(f(c)\)</span> has the positive minimum value <span class="math inline">\(f(c^*)\)</span> where <span class="math inline">\(c^*\)</span> is the minimizer of <span class="math inline">\(f\)</span> and has the expression as follow: <span class="math display">\[\begin{align}
c^* = \frac{q-r}{p+q-2r} = \frac{Var(\widehat{\theta}_2) - Cov(\widehat{\theta}_1,\widehat{\theta}_2)}{Var(\widehat{\theta}_1)+Var(\widehat{\theta}_2)-2Cov(\widehat{\theta}_1,\widehat{\theta}_2)}
\end{align}\]</span></p>
</div>
<div id="section-5" class="section level2">
<h2>2020/10/20</h2>
</div>
<div id="ex-5.13" class="section level2">
<h2>Ex 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\ \ x&gt;1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>The two importance functions (p.d.f) are shown as follow: <span class="math display">\[\begin{align}
  f_1(x) &amp;= e^{-(x-1)},\ \ x&gt;1,\\
  f_2(x) &amp;= \frac{\pi}{4} \frac{1}{1+x^2}, x&gt;1.
\end{align}\]</span></p>
<p>For <span class="math inline">\(f_1\)</span>, we generated <span class="math inline">\(x\)</span>’s from the exponential distribution <span class="math inline">\(EXp(1)\)</span> then use <span class="math inline">\(x+1\)</span> as samples.</p>
<p>For <span class="math inline">\(f_2\)</span>, we use the inverse transform method by using the result <span class="math inline">\(F(U)\sim U(0,1)\)</span> where <span class="math inline">\(F\)</span> is the cdf of <span class="math inline">\(r.v. U\)</span>.</p>
<p>The codes and results are shown as follow:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">set.seed</span>(<span class="dv">513</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x){x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)}</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co"># f_1</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>x<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">rexp</span>(m,<span class="dv">1</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>x<span class="fl">.1</span> &lt;-<span class="st"> </span>x<span class="fl">.1</span><span class="op">+</span><span class="dv">1</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x<span class="fl">.1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="fl">.1</span><span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb11-12"><a href="#cb11-12"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb11-13"><a href="#cb11-13"></a></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#f_2</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb11-16"><a href="#cb11-16"></a>x<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">tan</span>((<span class="dv">1</span><span class="op">+</span>u)<span class="op">*</span>pi<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb11-17"><a href="#cb11-17"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x<span class="fl">.2</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="fl">.2</span><span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>pi))</span>
<span id="cb11-18"><a href="#cb11-18"></a>theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb11-19"><a href="#cb11-19"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb11-20"><a href="#cb11-20"></a></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#result</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="kw">rbind</span>(theta.hat, se)</span></code></pre></div>
<pre><code>##                [,1]      [,2]
## theta.hat 0.4000968 0.4018054
## se        0.1579389 0.3298760</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>x<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">sort</span>(x<span class="fl">.1</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>x<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">sort</span>(x<span class="fl">.2</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dt">length.out =</span> m)</span>
<span id="cb13-4"><a href="#cb13-4"></a>y &lt;-<span class="st"> </span><span class="kw">g</span>(x)</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="kw">plot</span>(x,y,<span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="kw">lines</span>(x<span class="fl">.1</span>,<span class="kw">exp</span>(<span class="op">-</span>x<span class="fl">.1</span><span class="op">+</span><span class="dv">1</span>),<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="kw">lines</span>(x<span class="fl">.2</span>,(<span class="dv">4</span> <span class="op">/</span><span class="st"> </span>((<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="fl">.2</span><span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>pi)),<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;g&#39;</span>,<span class="st">&#39;f1&#39;</span>,<span class="st">&#39;f2&#39;</span>),<span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the result, <span class="math inline">\(f_1\)</span> produces the smaller variance in estimating the integral since <span class="math inline">\(f_1\)</span> is ‘closer’ to g and <span class="math inline">\(f_2\)</span> is heavy-tail which cause more fluction.</p>
</div>
<div id="ex-5.15" class="section level2">
<h2>Ex 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>In this exercise, we want to approximate the integral <span class="math display">\[\int_0^1\frac{e^{-x}}{1+x^2}dx\]</span> by stratified sampling. For <span class="math inline">\(j=0,1,2,3,4\)</span>, consider the following importance funcitns: <span class="math display">\[f_j (x) = \frac{e^{-x}}{e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}}}, \frac{j-1}{5}&lt;x&lt;\frac{j}{5}.\]</span></p>
<p>Let <span class="math inline">\(C_j = e^{-\frac{j-1}{5}}-e^{-\frac{j}{5}},j=0,1,,2,3,4\)</span>, then the c.d.f’s are <span class="math display">\[ F_j(x)=\frac{1}{C_j} \left(e^{-\frac{j-1}{5}}-e^{-x}\right), \frac{j-1}{5}&lt;x&lt;\frac{j}{5}.\]</span> Use the transform method, <span class="math inline">\(U_j = F_j(X) \sim U(0,1)\)</span>, then <span class="math display">\[ X_j = F^{-1}(U_j) = -\log\left(e^{-\frac{j-1}{5}} - C_j U_j\right).\]</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">set.seed</span>(<span class="dv">515</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>M &lt;-<span class="st"> </span><span class="dv">10000</span>; </span>
<span id="cb14-3"><a href="#cb14-3"></a>k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># what if k is larger?</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>r &lt;-<span class="st"> </span>M<span class="op">/</span>k <span class="co">#replicates per stratum</span></span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x){<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)}</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x,j){</span>
<span id="cb14-9"><a href="#cb14-9"></a>  C &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>(j<span class="dv">-1</span>))<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>j)</span>
<span id="cb14-10"><a href="#cb14-10"></a>  p &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>C</span>
<span id="cb14-11"><a href="#cb14-11"></a>}</span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a>X.trans &lt;-<span class="st"> </span><span class="cf">function</span>(u,j){</span>
<span id="cb14-14"><a href="#cb14-14"></a>  C &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>(j<span class="dv">-1</span>))<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>j)</span>
<span id="cb14-15"><a href="#cb14-15"></a>  x &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>(j<span class="dv">-1</span>))<span class="op">-</span>C<span class="op">*</span>u)</span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="kw">return</span>(x)</span>
<span id="cb14-17"><a href="#cb14-17"></a>}</span>
<span id="cb14-18"><a href="#cb14-18"></a></span>
<span id="cb14-19"><a href="#cb14-19"></a>theta.hat &lt;-<span class="st"> </span>sd &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb14-20"><a href="#cb14-20"></a></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {</span>
<span id="cb14-22"><a href="#cb14-22"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(r)</span>
<span id="cb14-23"><a href="#cb14-23"></a>  x &lt;-<span class="st"> </span><span class="kw">X.trans</span>(u,j)</span>
<span id="cb14-24"><a href="#cb14-24"></a>  fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f</span>(x,j)</span>
<span id="cb14-25"><a href="#cb14-25"></a>  theta.hat[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb14-26"><a href="#cb14-26"></a>  sd[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb14-27"><a href="#cb14-27"></a>}</span>
<span id="cb14-28"><a href="#cb14-28"></a>theta.total &lt;-<span class="st"> </span><span class="kw">sum</span>(theta.hat)</span>
<span id="cb14-29"><a href="#cb14-29"></a>sd.total &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(sd<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="co">#names(theta.total)=&quot;theta&quot;</span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="co">#names(sd.total)=&quot;sd&quot;</span></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="kw">c</span>(theta.total,sd.total)</span></code></pre></div>
<pre><code>## [1] 0.525144981 0.007861295</code></pre>
<p>In Example 5.10, the esitimated value and sd are <span class="math inline">\(0.52506988\)</span> and <span class="math inline">\(0.09658794\)</span>, respectively. The performance of stratified sampling is better, it has the smaller variance.</p>
</div>
<div id="ex-6.4" class="section level2">
<h2>Ex 6.4</h2>
<p>Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95\%\)</span> confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>Let <span class="math inline">\(Z \sim N(0,1)\)</span>, <span class="math inline">\(\mu \in \mathbf{R},\sigma &gt;0\)</span> are unknown parameters, then <span class="math inline">\(X=e^{\mu + \sigma Z}\)</span> has the log-normal distribution. Let <span class="math inline">\(\mu^* = e^{\mu}, \sigma^* = e^\sigma\)</span>, for normal distribution <span class="math inline">\(N(\mu,\sigma^2)\)</span>, the <span class="math inline">\(95\%\)</span> confidence interval is <span class="math inline">\((\widehat{\mu}-t_{n-1}(0.975)\cdots e,\widehat{\mu}+t_{n-1}(0.975)\cdot se)\)</span> where <span class="math inline">\(se = \widehat{\sigma}/\sqrt{n}\)</span> and <span class="math inline">\(t_{n-1}(0.975)\)</span> is the <span class="math inline">\(97.5\%\)</span> quantile of a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom. Then the coresponding %95%% confidence interval of log-normal distribution is <span class="math display">\[\left(\widehat{\mu^*}/{\left(\widehat{\sigma^*}\right)^{t_{n-1}(0.975)/\sqrt{n}}},\widehat{\mu^*}\cdot{\left(\widehat{\sigma^*}\right)^{t_{n-1}(0.975)/\sqrt{n}}}\right),\]</span> where <span class="math inline">\(\widehat{\mu^*} = e^{\widehat{\mu}}, \widehat{\sigma^*} = e^{\widehat{\sigma}}\)</span> and it is easy to conduct <span class="math display">\[\begin{align}
  \widehat{\mu} &amp;= \frac{1}{n} \sum_{i=1}^n \ln X_i \\
  \widehat{\sigma}^2 &amp;= \frac{1}{n-1} \sum_{i=1}^n \left(\ln X_i - \widehat{\mu}\right)^2
\end{align}\]</span></p>
<p>Next, we use MC method to obtain an empirical estimate of the confidence level:</p>
<p>In this exercise, we have <span class="math inline">\(\mu=0,\sigma=2,n=20,m=1000\)</span> replicates.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>mu &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>n &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="kw">set.seed</span>(<span class="dv">64</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a>mu.hat &lt;-<span class="st"> </span>mu.se &lt;-<span class="st"> </span>UCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a>calcCI &lt;-<span class="st"> </span><span class="cf">function</span>(n,mu,sigma){</span>
<span id="cb16-10"><a href="#cb16-10"></a>  x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n,<span class="dt">meanlog =</span> <span class="dv">0</span>,<span class="dt">sdlog =</span> <span class="dv">2</span>)</span>
<span id="cb16-11"><a href="#cb16-11"></a>  mu.hat &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">log</span>(x))<span class="op">/</span>n</span>
<span id="cb16-12"><a href="#cb16-12"></a>  sigma.hat &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">log</span>(x)<span class="op">-</span>mu.hat)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb16-13"><a href="#cb16-13"></a>  A &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">sqrt</span>(sigma.hat))<span class="op">^</span>{<span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)}</span>
<span id="cb16-14"><a href="#cb16-14"></a>  CI.left &lt;-<span class="st"> </span><span class="kw">exp</span>(mu.hat)<span class="op">/</span>A</span>
<span id="cb16-15"><a href="#cb16-15"></a>  CI.right &lt;-<span class="st"> </span><span class="kw">exp</span>(mu.hat)<span class="op">*</span>A</span>
<span id="cb16-16"><a href="#cb16-16"></a>  <span class="kw">names</span>(CI.left) &lt;-<span class="st"> &quot;Lowbound&quot;</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>  <span class="kw">names</span>(CI.right) &lt;-<span class="st"> &quot;Upbound&quot;</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>  <span class="kw">return</span>(<span class="kw">c</span>(CI.left,CI.right))</span>
<span id="cb16-19"><a href="#cb16-19"></a>}</span>
<span id="cb16-20"><a href="#cb16-20"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb16-22"><a href="#cb16-22"></a>  result &lt;-<span class="st"> </span><span class="kw">calcCI</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb16-23"><a href="#cb16-23"></a>  low &lt;-<span class="st"> </span>result[<span class="dv">1</span>]</span>
<span id="cb16-24"><a href="#cb16-24"></a>  up &lt;-<span class="st"> </span>result[<span class="dv">2</span>]</span>
<span id="cb16-25"><a href="#cb16-25"></a>  UCL[i] &lt;-<span class="st"> </span>low<span class="op">&lt;</span><span class="dv">1</span><span class="op">&amp;</span>up<span class="op">&gt;</span><span class="dv">1</span></span>
<span id="cb16-26"><a href="#cb16-26"></a>}</span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="kw">sum</span>(UCL)<span class="op">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.952</code></pre>
<p>From the simulted proportion that the true value located in the empirical CI, we can show that such a mathod to conduct CI is efficient.</p>
</div>
<div id="ex-6.5" class="section level2">
<h2>Ex 6.5</h2>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to <span class="math inline">\(0.95\)</span>. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2 (2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>The mean of <span class="math inline">\(\chi^2(2)\)</span> is <span class="math inline">\(2\)</span>. We do the simulation similar to Ex 6.4 but the samples are generated from <span class="math inline">\(\chi^2(2)\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>mu &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="kw">set.seed</span>(<span class="dv">651</span>)</span>
<span id="cb18-7"><a href="#cb18-7"></a>mu.hat &lt;-<span class="st"> </span>mu.se &lt;-<span class="st"> </span>UCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a>calcCI &lt;-<span class="st"> </span><span class="cf">function</span>(n){</span>
<span id="cb18-10"><a href="#cb18-10"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</span>
<span id="cb18-11"><a href="#cb18-11"></a>  mu.hat &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">log</span>(x))<span class="op">/</span>n</span>
<span id="cb18-12"><a href="#cb18-12"></a>  sigma.hat &lt;-<span class="st"> </span><span class="kw">sum</span>((<span class="kw">log</span>(x)<span class="op">-</span>mu.hat)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(n<span class="dv">-1</span>)</span>
<span id="cb18-13"><a href="#cb18-13"></a>  A &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">sqrt</span>(sigma.hat))<span class="op">^</span>{<span class="kw">qt</span>(<span class="fl">0.975</span>,<span class="dt">df=</span>n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n)}</span>
<span id="cb18-14"><a href="#cb18-14"></a>  CI.left &lt;-<span class="st"> </span><span class="kw">exp</span>(mu.hat)<span class="op">/</span>A</span>
<span id="cb18-15"><a href="#cb18-15"></a>  CI.right &lt;-<span class="st"> </span><span class="kw">exp</span>(mu.hat)<span class="op">*</span>A</span>
<span id="cb18-16"><a href="#cb18-16"></a>  <span class="kw">names</span>(CI.left) &lt;-<span class="st"> &quot;Lowbound&quot;</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>  <span class="kw">names</span>(CI.right) &lt;-<span class="st"> &quot;Upbound&quot;</span></span>
<span id="cb18-18"><a href="#cb18-18"></a>  <span class="kw">return</span>(<span class="kw">c</span>(CI.left,CI.right))</span>
<span id="cb18-19"><a href="#cb18-19"></a>}</span>
<span id="cb18-20"><a href="#cb18-20"></a></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb18-22"><a href="#cb18-22"></a>  result &lt;-<span class="st"> </span><span class="kw">calcCI</span>(n)</span>
<span id="cb18-23"><a href="#cb18-23"></a>  low &lt;-<span class="st"> </span>result[<span class="dv">1</span>]</span>
<span id="cb18-24"><a href="#cb18-24"></a>  up &lt;-<span class="st"> </span>result[<span class="dv">2</span>]</span>
<span id="cb18-25"><a href="#cb18-25"></a>  UCL[i] &lt;-<span class="st"> </span>low<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;</span>up<span class="op">&gt;</span><span class="dv">2</span></span>
<span id="cb18-26"><a href="#cb18-26"></a>}</span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="kw">sum</span>(UCL)<span class="op">/</span>m</span></code></pre></div>
<pre><code>## [1] 0.516</code></pre>
<p>The proportion that the true mean <span class="math inline">\(2\)</span> located in the esitimated CI is 0.545, less than the theorical one.</p>
<p>The variance of <span class="math inline">\(\chi^2(2)\)</span> is 4. When t-interval is applied to esitiamting the CI for variance:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">set.seed</span>(<span class="dv">652</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>m &lt;-<span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb20-5"><a href="#cb20-5"></a>UCL &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb20-7"><a href="#cb20-7"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb20-8"><a href="#cb20-8"></a>  Upbound &lt;-<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha,<span class="dt">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb20-9"><a href="#cb20-9"></a>  UCL[i] &lt;-<span class="st"> </span>Upbound<span class="op">&gt;</span><span class="dv">4</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>}</span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="kw">sum</span>(UCL<span class="op">/</span>m)</span></code></pre></div>
<pre><code>## [1] 0.95</code></pre>
<p>The simulated proportion that the esitimated CI contains true variance is <span class="math inline">\(0.95\)</span>, which is equal to the theorical one.</p>
<p>The proportion in conducting CI for mean and variance when sample data are non-normal can illustrast that the t-interval should be more robust to departures from normality than the interval for variance.</p>
</div>
<div id="section-6" class="section level2">
<h2>2020/10/27</h2>
</div>
<div id="section-7" class="section level2">
<h2>6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha,\alpha\)</span>) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>The skewness <span class="math inline">\(\sqrt{\beta_1}\)</span> of a random variable <span class="math inline">\(X\)</span> is defined by <span class="math display">\[\sqrt{\beta_1} = \frac{E[(X-\mu_X)]^3}{\sigma^2_X},\]</span> where <span class="math inline">\(\mu_X = E[X]\)</span> and <span class="math inline">\(\sigma_X^2 = Var(X)\)</span>. We consider a hypothesis of normalilty for distribution <span class="math inline">\(Beta(\alpha,\alpha)\)</span> as follow <span class="math display">\[ H_0:\sqrt{\beta_1}=0;\ \ \ \ \ H_1:\sqrt{\beta_1}\neq 0.\]</span> And the test statistic is the coefficient of skewness <span class="math inline">\(\sqrt{b_1}\)</span> defined as <span class="math display">\[\sqrt{b_1}=\frac{ \frac{1}{n}\sum_{i=1}^n(X_i - \bar{X})^3}{(\frac{1}{n}\sum_{i=1}^n(X_i-\bar{X})^2)^{3/2}},\]</span> where the samples are generated from <span class="math inline">\(Beta(\alpha,\alpha)\)</span>. We start the simulation and set <span class="math inline">\(\alpha=2\)</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">set.seed</span>(<span class="dv">67</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>nu &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>alpha &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb22-5"><a href="#cb22-5"></a></span>
<span id="cb22-6"><a href="#cb22-6"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) <span class="co">#crit. values for each n</span></span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb22-10"><a href="#cb22-10"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb22-12"><a href="#cb22-12"></a>  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb22-13"><a href="#cb22-13"></a>  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb22-15"><a href="#cb22-15"></a>}</span>
<span id="cb22-16"><a href="#cb22-16"></a></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb22-19"><a href="#cb22-19"></a>p.reject2 &lt;-<span class="st"> </span>p.reject1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb22-22"><a href="#cb22-22"></a>sktests2 &lt;-<span class="st"> </span>sktests1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb22-23"><a href="#cb22-23"></a></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co"># beta(alpha,alpha) distribution</span></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb22-26"><a href="#cb22-26"></a>x1 &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n[i],alpha,alpha)</span>
<span id="cb22-27"><a href="#cb22-27"></a><span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb22-28"><a href="#cb22-28"></a>sktests1[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x1)) <span class="op">&gt;=</span><span class="st"> </span>cv[i] )</span>
<span id="cb22-29"><a href="#cb22-29"></a>}</span>
<span id="cb22-30"><a href="#cb22-30"></a>p.reject1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests1) <span class="co">#proportion rejected</span></span>
<span id="cb22-31"><a href="#cb22-31"></a>}</span>
<span id="cb22-32"><a href="#cb22-32"></a><span class="co"># t distribution</span></span>
<span id="cb22-33"><a href="#cb22-33"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb22-34"><a href="#cb22-34"></a>sktests2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb22-35"><a href="#cb22-35"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb22-36"><a href="#cb22-36"></a>x2 &lt;-<span class="st"> </span><span class="kw">rt</span>(n[i],<span class="dv">2</span>)</span>
<span id="cb22-37"><a href="#cb22-37"></a><span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb22-38"><a href="#cb22-38"></a>sktests2[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x2)) <span class="op">&gt;=</span><span class="st"> </span>cv[i] )</span>
<span id="cb22-39"><a href="#cb22-39"></a>}</span>
<span id="cb22-40"><a href="#cb22-40"></a>p.reject2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests2) <span class="co">#proportion rejected</span></span>
<span id="cb22-41"><a href="#cb22-41"></a>}</span>
<span id="cb22-42"><a href="#cb22-42"></a></span>
<span id="cb22-43"><a href="#cb22-43"></a>p.reject1 <span class="co"># for beta(alpha,alpha)</span></span></code></pre></div>
<pre><code>## [1] 0.0039 0.0028 0.0018 0.0017 0.0014 0.0009</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>p.reject2 <span class="co"># for t(nu)</span></span></code></pre></div>
<pre><code>## [1] 0.1961 0.4511 0.5676 0.6925 0.8122 0.9387</code></pre>
<p>The proportion rejected is small which indicates that we shall accept the null hypothesis. In practice, <span class="math inline">\(Beta(\alpha,\alpha)\)</span> is a symmetric distribution illustrated by the following pdf curves:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>temp &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb26-2"><a href="#cb26-2"></a>pdf2 &lt;-<span class="st"> </span>temp<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>temp)<span class="op">/</span><span class="kw">beta</span>(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>pdf3 &lt;-<span class="st"> </span>temp<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>temp)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">beta</span>(<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a>pdf4 &lt;-<span class="st"> </span>temp<span class="op">^</span><span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>temp)<span class="op">^</span><span class="dv">3</span><span class="op">/</span><span class="kw">beta</span>(<span class="dv">4</span>,<span class="dv">4</span>)</span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="kw">plot</span>(temp,pdf4,<span class="dt">main =</span> <span class="st">&quot;Beta(alpha,alpha)&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="dv">4</span>)</span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="kw">lines</span>(temp,pdf3,<span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="kw">lines</span>(temp,pdf2,<span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;alpha=2&#39;</span>,<span class="st">&#39;alpha=3&#39;</span>,<span class="st">&#39;alpha=4&#39;</span>),<span class="dt">col=</span><span class="dv">2</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> On the other hand, student t distibution <span class="math inline">\(t(\nu)\)</span> is also a symmetric distribution but heavy-tailed, and the proportion rejected raises as the sample size growing, which means that in the heavy-tailed case, <span class="math inline">\(\sqrt{b_1}\)</span> is not a good test statistic and it will lead to the mistake.</p>
</div>
<div id="ex-6.8" class="section level2">
<h2>Ex 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} = 0.055\)</span>. Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<p>We set sample sizes as <span class="math inline">\(10, 20, 30, 50, 100, 500\)</span> and compare the proportions rejected of Count5test and F test.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="kw">set.seed</span>(<span class="dv">68</span>)</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co"># sample size</span></span>
<span id="cb27-7"><a href="#cb27-7"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb27-8"><a href="#cb27-8"></a></span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co"># The function count5test returns the value 1</span></span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="co"># (reject H0) or 0 (do not reject H0)</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb27-13"><a href="#cb27-13"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb27-14"><a href="#cb27-14"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb27-15"><a href="#cb27-15"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb27-16"><a href="#cb27-16"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb27-17"><a href="#cb27-17"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb27-18"><a href="#cb27-18"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb27-19"><a href="#cb27-19"></a>}</span>
<span id="cb27-20"><a href="#cb27-20"></a></span>
<span id="cb27-21"><a href="#cb27-21"></a>power &lt;-<span class="st"> </span>Ftest &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb27-22"><a href="#cb27-22"></a>por.power &lt;-<span class="st"> </span>por.Ftest &lt;-<span class="st">  </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb27-24"><a href="#cb27-24"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb27-25"><a href="#cb27-25"></a>  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma1)</span>
<span id="cb27-26"><a href="#cb27-26"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[j], <span class="dv">0</span>, sigma2)</span>
<span id="cb27-27"><a href="#cb27-27"></a>  power[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x, y)</span>
<span id="cb27-28"><a href="#cb27-28"></a>  Ftest[i] &lt;-<span class="st"> </span><span class="kw">var.test</span>(x,y,<span class="dt">conf.level =</span> <span class="fl">0.945</span>)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb27-29"><a href="#cb27-29"></a>  }</span>
<span id="cb27-30"><a href="#cb27-30"></a>  por.power[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(power)</span>
<span id="cb27-31"><a href="#cb27-31"></a>  por.Ftest[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(Ftest)</span>
<span id="cb27-32"><a href="#cb27-32"></a>}</span>
<span id="cb27-33"><a href="#cb27-33"></a><span class="co"># count5test</span></span>
<span id="cb27-34"><a href="#cb27-34"></a>por.power</span></code></pre></div>
<pre><code>## [1] 0.1082 0.3035 0.4675 0.6622 0.8536 0.9920</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># F test</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>por.Ftest</span></code></pre></div>
<pre><code>## [1] 0.2122 0.4100 0.5919 0.8108 0.9827 1.0000</code></pre>
<p>Form the above results, both of the proportion rejected of count5test and the proportion rejected of F test raise as sample size growing. And F test always performs better than count5test, whatever for small, medium, and large sample sizes. The proportion rejected is small in the small sample size case but close to 1 in the large sample size, which shows that both of them perform well for large sample size but worse for small sample size.</p>
</div>
<div id="ex-6.c" class="section level2">
<h2>Ex 6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span>,d is defined by Mardia as <span class="math display">\[\beta_{1,d} = E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3.\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d} = \frac{1}{n^2} \sum_{i,j=1}^n ((X_i-\bar{X})^T\widehat{\Sigma}^{-1}(X_j-\bar{X}))^3,\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is the chisquared with <span class="math inline">\(d(d+1)(d+2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>Repeat Example 6.8: for the case dimension <span class="math inline">\(d=1\)</span>, <span class="math inline">\(\boldsymbol{X}=(X_1,...,X_n)^T\)</span> is the samples, then the estimated covariance by maximizing the likelihood is <span class="math inline">\(\hat{\Sigma} = \frac{1}{n} \sum_{i}^n(X_1-\bar{X})^2\)</span>. <span class="math display">\[b_{1,1}=\frac{1}{n^2}\sum_{i,j=1}^n\left\{(X_i-\bar{X})\left(\frac{1}{n}\sum_{i=1}^n (X_i-\bar{X})^2\right)^{-1}(X_j-\bar{X})\right\}^3= n \left(\sum_{k=1}^n(X_k-\bar{X})^2\right)^{-3}\sum_{i,j=1}^n\left((X_i-\bar{X})(X_j-\bar{X})\right)^3\]</span></li>
</ol>
<p>And the critical values are relevent to chi-squared distribution <span class="math inline">\(\chi^2_1\)</span>. The codes and result are given as follow:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">666</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) <span class="co">#sample sizes</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>cv<span class="fl">.6</span>C &lt;-<span class="st"> </span><span class="kw">qchisq</span>(.<span class="dv">95</span>, <span class="dv">1</span>)<span class="co">#crit. values for each n</span></span>
<span id="cb31-4"><a href="#cb31-4"></a></span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>sk<span class="fl">.6</span>C &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb31-7"><a href="#cb31-7"></a>  <span class="co">#computes the sample skewness coeff by  Mardia&#39;s approach.</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>  len &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb31-9"><a href="#cb31-9"></a>  x&lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</span>
<span id="cb31-10"><a href="#cb31-10"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb31-11"><a href="#cb31-11"></a>  m1 &lt;-<span class="st"> </span><span class="kw">sum</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb31-12"><a href="#cb31-12"></a>  mat &lt;-<span class="st"> </span>(x<span class="op">-</span>xbar)<span class="op">%*%</span><span class="kw">t</span>(x<span class="op">-</span>xbar)</span>
<span id="cb31-13"><a href="#cb31-13"></a>  mat &lt;-<span class="st"> </span>mat<span class="op">^</span><span class="dv">3</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>  m2 &lt;-<span class="st"> </span><span class="kw">sum</span>(mat)</span>
<span id="cb31-15"><a href="#cb31-15"></a>  <span class="kw">return</span>(len<span class="op">*</span>m2<span class="op">*</span>m1<span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>))</span>
<span id="cb31-16"><a href="#cb31-16"></a>}</span>
<span id="cb31-17"><a href="#cb31-17"></a><span class="co"># repeat example 6.8</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>p.reject<span class="fl">.6</span>C1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#num. repl. each sim.</span></span>
<span id="cb31-20"><a href="#cb31-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb31-21"><a href="#cb31-21"></a>sktests<span class="fl">.6</span>C1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb31-22"><a href="#cb31-22"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb31-23"><a href="#cb31-23"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i])</span>
<span id="cb31-24"><a href="#cb31-24"></a><span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb31-25"><a href="#cb31-25"></a>sktests<span class="fl">.6</span>C1[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n[i]<span class="op">*</span><span class="kw">sk.6C</span>(x)<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv<span class="fl">.6</span>C )</span>
<span id="cb31-26"><a href="#cb31-26"></a>}</span>
<span id="cb31-27"><a href="#cb31-27"></a>p.reject<span class="fl">.6</span>C1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests<span class="fl">.6</span>C1) <span class="co">#proportion rejected</span></span>
<span id="cb31-28"><a href="#cb31-28"></a>}</span>
<span id="cb31-29"><a href="#cb31-29"></a>p.reject<span class="fl">.6</span>C1</span></code></pre></div>
<pre><code>## [1] 0.0136 0.0291 0.0347 0.0402 0.0450 0.0498</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">#repeat example 6.10</span></span>
<span id="cb33-2"><a href="#cb33-2"></a></span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb33-8"><a href="#cb33-8"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb33-9"><a href="#cb33-9"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb33-10"><a href="#cb33-10"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb33-11"><a href="#cb33-11"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dv">1</span>)</span>
<span id="cb33-12"><a href="#cb33-12"></a></span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {   <span class="co">#for each epsilon</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb33-15"><a href="#cb33-15"></a>sktests<span class="fl">.6</span>C2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb33-17"><a href="#cb33-17"></a>sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb33-18"><a href="#cb33-18"></a><span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb33-19"><a href="#cb33-19"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb33-20"><a href="#cb33-20"></a>sktests<span class="fl">.6</span>C2[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">sk.6C</span>(x)<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb33-21"><a href="#cb33-21"></a>}</span>
<span id="cb33-22"><a href="#cb33-22"></a>pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests<span class="fl">.6</span>C2)</span>
<span id="cb33-23"><a href="#cb33-23"></a>}</span>
<span id="cb33-24"><a href="#cb33-24"></a><span class="co"># the proportion rejected</span></span>
<span id="cb33-25"><a href="#cb33-25"></a>pwr</span></code></pre></div>
<pre><code>##  [1] 0.0892 0.2640 0.4244 0.5216 0.6100 0.6504 0.7216 0.7376 0.7800 0.7828
## [11] 0.8068 0.8060 0.8300 0.8164 0.8060 0.8080 0.8204 0.7692 0.7344 0.6688
## [21] 0.6216 0.5648 0.5028 0.4316 0.3808 0.3280 0.3020 0.2564 0.2088 0.1844
## [31] 0.1616 0.1292 0.0928 0.0924</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="discussion" class="section level2">
<h2>Discussion</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li><p>Test null hypothesis <span class="math inline">\(H_0: \text{The two methods have the same power.}\)</span></p></li>
<li><p>We should use McNemar test since it is relevent to the class test.</p></li>
<li><p>Consider the folowing <span class="math inline">\(2\times2\)</span> McNemar</p></li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">6510</span>,<span class="dv">3490</span>,<span class="dv">10000</span>,<span class="dv">6760</span>,<span class="dv">3240</span>,<span class="dv">10000</span>,<span class="dv">13270</span>,<span class="dv">6730</span>,<span class="dv">20000</span>),<span class="dv">3</span>,<span class="dv">3</span>,<span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;Rejected&quot;</span>,<span class="st">&quot;Accepted&quot;</span>,<span class="st">&quot;total&quot;</span>),<span class="kw">c</span>(<span class="st">&quot;A method&quot;</span>,<span class="st">&quot;B method&quot;</span>,<span class="st">&quot;total&quot;</span>)))</span>
<span id="cb36-2"><a href="#cb36-2"></a>mat</span></code></pre></div>
<pre><code>##          A method B method total
## Rejected     6510     6760 13270
## Accepted     3490     3240  6730
## total       10000    10000 20000</code></pre>
<p>And the test statistic is Pearson <span class="math display">\[\chi^2 = \sum_{i,j=1}^2 \frac{(n_{ij}-n_{i+} n_{+j}/n)^2}{n_{i+}n_{+j}/n} \rightarrow \chi^2_1.\]</span> We have <span class="math inline">\(\chi^2 = 13.9966\)</span> and <span class="math inline">\(p-value = P(\chi^2_1 &gt; \chi^2) = 0.0001831415 &lt; 0.05\)</span>. Therefore, we reject the null hyppthesis <span class="math inline">\(H_0\)</span> so we can say the powers are different at <span class="math inline">\(0.05\)</span> level.</p>
</div>
<div id="section-8" class="section level2">
<h2>2020/11/03</h2>
</div>
<div id="ex-7.1" class="section level2">
<h2>Ex 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="kw">data</span>(law, <span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb38-4"><a href="#cb38-4"></a>y &lt;-<span class="st"> </span>law<span class="op">$</span>LSAT</span>
<span id="cb38-5"><a href="#cb38-5"></a>z &lt;-<span class="st"> </span>law<span class="op">$</span>GPA</span>
<span id="cb38-6"><a href="#cb38-6"></a>mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(law)</span>
<span id="cb38-7"><a href="#cb38-7"></a>theta.hat &lt;-<span class="kw">corr</span>(mat)</span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="kw">print</span> (theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb40-4"><a href="#cb40-4"></a>  mat.i &lt;-<span class="st"> </span>mat[<span class="op">-</span>i,]</span>
<span id="cb40-5"><a href="#cb40-5"></a>  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">corr</span>(mat.i)</span>
<span id="cb40-6"><a href="#cb40-6"></a>}</span>
<span id="cb40-7"><a href="#cb40-7"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb40-8"><a href="#cb40-8"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb40-9"><a href="#cb40-9"></a></span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="kw">print</span>(<span class="kw">c</span>(bias,se)) <span class="co"># jackknife estimate of the bias and the standard error</span></span></code></pre></div>
<pre><code>## [1] -0.006473623  0.142518619</code></pre>
</div>
<div id="ex-7.5" class="section level2">
<h2>Ex 7.5</h2>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="kw">data</span>(aircondit, <span class="dt">package =</span> <span class="st">&quot;boot&quot;</span>)</span>
<span id="cb42-3"><a href="#cb42-3"></a>air.time &lt;-<span class="st"> </span>aircondit<span class="op">$</span>hours</span>
<span id="cb42-4"><a href="#cb42-4"></a>theta.boot &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])</span>
<span id="cb42-5"><a href="#cb42-5"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(air.time, <span class="dt">statistic =</span> theta.boot, <span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="kw">print</span>(boot.obj)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = air.time, statistic = theta.boot, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original     bias    std. error
## t1* 108.0833 0.06595833    37.18608</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">print</span>(<span class="kw">boot.ci</span>(boot.obj, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>)))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.1, 180.9 )   ( 23.4, 169.9 )  
## 
## Level     Percentile            BCa          
## 95%   ( 46.2, 192.7 )   ( 57.7, 224.8 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="ex-7.8" class="section level2">
<h2>Ex 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>The MLE of <span class="math inline">\(\Sigma\)</span> is <span class="math display">\[\widehat{\Sigma} = \frac{1}{n} \sum_{i=1}^n (\boldsymbol{x}_i - \boldsymbol{\bar{x}})(\boldsymbol{x}_i - \boldsymbol{\bar{x}})^T,\]</span> where <span class="math inline">\(\boldsymbol{x}_i = (x_{i1},...,x_{i1})^T, \boldsymbol{\bar{x}} = \frac{1}{n} \sum_{i=1}^n \boldsymbol{x}_i\)</span> are vactors.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>score &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(scor)</span>
<span id="cb48-2"><a href="#cb48-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(score)</span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>Sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(score)</span>
<span id="cb48-5"><a href="#cb48-5"></a>eigens &lt;-<span class="st"> </span><span class="kw">eigen</span>(Sigma)<span class="op">$</span>values</span>
<span id="cb48-6"><a href="#cb48-6"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">max</span>(eigens)<span class="op">/</span><span class="kw">sum</span>(eigens)</span>
<span id="cb48-7"><a href="#cb48-7"></a>theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb48-9"><a href="#cb48-9"></a>  Sigma.hat.i &lt;-<span class="st"> </span><span class="kw">cov</span>(score[<span class="op">-</span>i,])</span>
<span id="cb48-10"><a href="#cb48-10"></a>  eigens.i &lt;-<span class="st"> </span><span class="kw">eigen</span>(Sigma.hat.i)<span class="op">$</span>values</span>
<span id="cb48-11"><a href="#cb48-11"></a>  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">max</span>(eigens.i)<span class="op">/</span><span class="kw">sum</span>(eigens.i)</span>
<span id="cb48-12"><a href="#cb48-12"></a>}</span>
<span id="cb48-13"><a href="#cb48-13"></a>bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb48-14"><a href="#cb48-14"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb48-15"><a href="#cb48-15"></a></span>
<span id="cb48-16"><a href="#cb48-16"></a><span class="kw">print</span>(theta.hat) <span class="co"># </span></span></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">print</span>(<span class="kw">c</span>(bias,se)) <span class="co"># jackknife estimate of the bias and the standard error</span></span></code></pre></div>
<pre><code>## [1] 0.001069139 0.049552307</code></pre>
</div>
<div id="ex-7.11" class="section level2">
<h2>Ex 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb57-4"><a href="#cb57-4"></a></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="co"># functions to be cross-validated.</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>theta.fit<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb57-7"><a href="#cb57-7"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb57-8"><a href="#cb57-8"></a>}</span>
<span id="cb57-9"><a href="#cb57-9"></a>theta.predict<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="cf">function</span>(fit,x){</span>
<span id="cb57-10"><a href="#cb57-10"></a>  <span class="kw">cbind</span>(<span class="dv">1</span>,x)<span class="op">%*%</span>fit<span class="op">$</span>coef</span>
<span id="cb57-11"><a href="#cb57-11"></a>}</span>
<span id="cb57-12"><a href="#cb57-12"></a></span>
<span id="cb57-13"><a href="#cb57-13"></a>theta.fit<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb57-14"><a href="#cb57-14"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb57-15"><a href="#cb57-15"></a>}</span>
<span id="cb57-16"><a href="#cb57-16"></a>theta.predict<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="cf">function</span>(fit,x){</span>
<span id="cb57-17"><a href="#cb57-17"></a>  <span class="kw">cbind</span>(<span class="dv">1</span>,x,x<span class="op">^</span><span class="dv">2</span>)<span class="op">%*%</span>fit<span class="op">$</span>coef</span>
<span id="cb57-18"><a href="#cb57-18"></a>}</span>
<span id="cb57-19"><a href="#cb57-19"></a></span>
<span id="cb57-20"><a href="#cb57-20"></a>theta.fit<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb57-21"><a href="#cb57-21"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb57-22"><a href="#cb57-22"></a>}</span>
<span id="cb57-23"><a href="#cb57-23"></a>theta.predict<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="cf">function</span>(fit,x){</span>
<span id="cb57-24"><a href="#cb57-24"></a>  <span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dv">1</span>,x)<span class="op">%*%</span>fit<span class="op">$</span>coef)</span>
<span id="cb57-25"><a href="#cb57-25"></a>}</span>
<span id="cb57-26"><a href="#cb57-26"></a></span>
<span id="cb57-27"><a href="#cb57-27"></a>theta.fit<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){</span>
<span id="cb57-28"><a href="#cb57-28"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb57-29"><a href="#cb57-29"></a>}</span>
<span id="cb57-30"><a href="#cb57-30"></a>theta.predict<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="cf">function</span>(fit,x){</span>
<span id="cb57-31"><a href="#cb57-31"></a>  <span class="kw">exp</span>(<span class="kw">cbind</span>(<span class="dv">1</span>,<span class="kw">log</span>(x))<span class="op">%*%</span>fit<span class="op">$</span>coef)</span>
<span id="cb57-32"><a href="#cb57-32"></a>}</span>
<span id="cb57-33"><a href="#cb57-33"></a><span class="co"># results of CV.</span></span>
<span id="cb57-34"><a href="#cb57-34"></a>results<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">crossval</span>(chemical,magnetic,<span class="dt">theta.fit=</span> theta.fit<span class="fl">.1</span>,<span class="dt">theta.predict =</span> theta.predict<span class="fl">.1</span>,<span class="dt">ngroup =</span> n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb57-35"><a href="#cb57-35"></a>results<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">crossval</span>(chemical,magnetic,<span class="dt">theta.fit=</span> theta.fit<span class="fl">.2</span>,<span class="dt">theta.predict =</span> theta.predict<span class="fl">.2</span>,<span class="dt">ngroup =</span> n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb57-36"><a href="#cb57-36"></a>results<span class="fl">.3</span> &lt;-<span class="st"> </span><span class="kw">crossval</span>(chemical,magnetic,<span class="dt">theta.fit=</span> theta.fit<span class="fl">.3</span>,<span class="dt">theta.predict =</span> theta.predict<span class="fl">.3</span>,<span class="dt">ngroup =</span> n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb57-37"><a href="#cb57-37"></a>results<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">crossval</span>(chemical,magnetic,<span class="dt">theta.fit=</span> theta.fit<span class="fl">.4</span>,<span class="dt">theta.predict =</span> theta.predict<span class="fl">.4</span>,<span class="dt">ngroup =</span> n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb57-38"><a href="#cb57-38"></a><span class="co"># errors of each method</span></span>
<span id="cb57-39"><a href="#cb57-39"></a>e1 &lt;-<span class="st"> </span>magnetic <span class="op">-</span><span class="st"> </span>results<span class="fl">.1</span><span class="op">$</span>cv.fit</span>
<span id="cb57-40"><a href="#cb57-40"></a>e2 &lt;-<span class="st"> </span>magnetic <span class="op">-</span><span class="st"> </span>results<span class="fl">.2</span><span class="op">$</span>cv.fit</span>
<span id="cb57-41"><a href="#cb57-41"></a>e3 &lt;-<span class="st"> </span>magnetic <span class="op">-</span><span class="st"> </span>results<span class="fl">.3</span><span class="op">$</span>cv.fit</span>
<span id="cb57-42"><a href="#cb57-42"></a>e4 &lt;-<span class="st"> </span>magnetic <span class="op">-</span><span class="st"> </span>results<span class="fl">.4</span><span class="op">$</span>cv.fit</span>
<span id="cb57-43"><a href="#cb57-43"></a><span class="co">#compare the four methods</span></span>
<span id="cb57-44"><a href="#cb57-44"></a><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55782 17.90683 18.20721 20.27909</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># L2 is the best model</span></span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>Form the above results, the L2 is the best of the four methods that is similar to leave-one-out result.</p>
</div>
<div id="section-9" class="section level2">
<h2>2020/11/10</h2>
</div>
<div id="ex-8.3" class="section level2">
<h2>Ex 8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>Suppose that <span class="math inline">\(X_1,...,X_n \overset{iid} \sim F(\frac{x-\theta_1}{\sigma_1})\)</span> and <span class="math inline">\(Y_1,...,Y_m \overset{iid} \sim F(\frac{x-\theta_2}{\sigma_2})\)</span>. Consider the hypothesis test <span class="math display">\[H_0:\sigma_1=\sigma_2\leftrightarrow H_1: \sigma_1\neq\sigma_2.\]</span></p>
<p>Without loss of generality, we assume <span class="math inline">\(\theta_1 = \theta_2=0\)</span>. Then, under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(X_1,...,X_n,Y_1,...,Y_m \overset{iid} \sim F(\frac{x}{\sigma})\)</span>.</p>
<p>Let <span class="math inline">\(Z=(Z_1,...,Z_N) = (X_1,...,X_n,Y_1,...,Y_m)\)</span> with <span class="math inline">\(N=n+m\)</span>. Then under <span class="math inline">\(H_0\)</span>, <span class="math inline">\(Z\)</span> is uniformly distributed in the set <span class="math display">\[\left\{1,2,...,\left(\begin{array}{c}N\\n\end{array}\right)\right\}.\]</span></p>
<p>Based on maximum number of extreme points, we consider the statistic <span class="math inline">\(T=T(Z)=T(X,Y)\)</span> as following: <span class="math display">\[T_1(Z) = \sum_{i=1}^n I (Z_i &gt; \max_{k=n+1,...,n+m}Z_k) + \sum_{i=1}^n T(Z_i &lt; \min_{k=n+1,...,n+m}Z_k),\]</span> <span class="math display">\[T_2(Z) = \sum_{i=n+1}^N I (Z_i &gt; \max_{k=1,...,n}Z_k) + \sum_{i=n+1}^N T(Z_i &lt; \min_{k=1,...,n}Z_k), \]</span> <span class="math display">\[T(Z) = \max(T_1(Z),T_2(Z)).\]</span></p>
</div>
<div id="ex-q2" class="section level2">
<h2>EX Q2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations</p>
<ol style="list-style-type: decimal">
<li><p>Unequal variances and equal expectations</p></li>
<li><p>Unequal variances and unequal expectations</p></li>
<li><p>Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</p></li>
<li><p>Unbalanced samples (say, 1 case versus 10 controls)</p></li>
<li><p>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</p></li>
</ol>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<p>We generate such samples from different cases：</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(X\sim N(0,1),Y\sim N(0,2)\)</span></p></li>
<li><p><span class="math inline">\(X\sim N(0,1),Y\sim N(3,2)\)</span></p></li>
<li><p>t distribution <span class="math inline">\(X,Y\sim t_1\)</span> whlie variance does not exsit while binomial <span class="math inline">\(X\sim 0.5*N(0,1)+0.5*N(0,4),Y\sim 0.5*N(0,1)+0.5*N(0,16)\)</span>.</p></li>
<li><p>Consider the simple 2-classification, generate sample from <span class="math inline">\(X,Y\sim Benoulli(1,10/11)\)</span>, it is the <span class="math inline">\(1\)</span> case versus <span class="math inline">\(10\)</span> controls situation.</p></li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="kw">library</span>(RANN)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="kw">library</span>(energy)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="kw">library</span>(Ball)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">library</span>(kableExtra)</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># experiments for evaluating the performance of the NN,</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="co"># energy, and ball methods in various situations.</span></span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a></span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="co"># statistic for NN</span></span>
<span id="cb68-6"><a href="#cb68-6"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb68-7"><a href="#cb68-7"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb68-9"><a href="#cb68-9"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb68-10"><a href="#cb68-10"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb68-11"><a href="#cb68-11"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb68-12"><a href="#cb68-12"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb68-13"><a href="#cb68-13"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb68-14"><a href="#cb68-14"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb68-15"><a href="#cb68-15"></a>}</span>
<span id="cb68-16"><a href="#cb68-16"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb68-17"><a href="#cb68-17"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb68-18"><a href="#cb68-18"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb68-19"><a href="#cb68-19"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb68-20"><a href="#cb68-20"></a>p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb68-21"><a href="#cb68-21"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb68-22"><a href="#cb68-22"></a>}</span>
<span id="cb68-23"><a href="#cb68-23"></a><span class="co"># settings</span></span>
<span id="cb68-24"><a href="#cb68-24"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span>; k&lt;-<span class="dv">3</span>; p&lt;-<span class="dv">2</span>; mu &lt;-<span class="st"> </span><span class="fl">0.5</span>;</span>
<span id="cb68-25"><a href="#cb68-25"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span>; R&lt;-<span class="dv">999</span>; n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb68-26"><a href="#cb68-26"></a></span>
<span id="cb68-27"><a href="#cb68-27"></a><span class="co"># power comparison </span></span>
<span id="cb68-28"><a href="#cb68-28"></a></span>
<span id="cb68-29"><a href="#cb68-29"></a><span class="co"># case 1: Unequal variances and equal expectations</span></span>
<span id="cb68-30"><a href="#cb68-30"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb68-31"><a href="#cb68-31"></a>p.values<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-32"><a href="#cb68-32"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-33"><a href="#cb68-33"></a>x1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);</span>
<span id="cb68-34"><a href="#cb68-34"></a>y1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">sd=</span><span class="dv">2</span>),<span class="kw">rnorm</span>(n2,<span class="dt">sd=</span><span class="dv">2</span>));</span>
<span id="cb68-35"><a href="#cb68-35"></a>z1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x1,y1)</span>
<span id="cb68-36"><a href="#cb68-36"></a>p.values<span class="fl">.1</span>[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z1,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-37"><a href="#cb68-37"></a>p.values<span class="fl">.1</span>[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z1,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-38"><a href="#cb68-38"></a>p.values<span class="fl">.1</span>[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x1,<span class="dt">y=</span>y1,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.va</span>
<span id="cb68-39"><a href="#cb68-39"></a>}</span>
<span id="cb68-40"><a href="#cb68-40"></a></span>
<span id="cb68-41"><a href="#cb68-41"></a><span class="co"># case 2: Unequal variances and Unequal expectations</span></span>
<span id="cb68-42"><a href="#cb68-42"></a>p.values<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-43"><a href="#cb68-43"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-44"><a href="#cb68-44"></a>x2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);</span>
<span id="cb68-45"><a href="#cb68-45"></a>y2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">2</span>),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span><span class="dv">3</span>,<span class="dt">sd=</span><span class="dv">2</span>));</span>
<span id="cb68-46"><a href="#cb68-46"></a>z2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x2,y2)</span>
<span id="cb68-47"><a href="#cb68-47"></a>p.values<span class="fl">.2</span>[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z2,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-48"><a href="#cb68-48"></a>p.values<span class="fl">.2</span>[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z2,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-49"><a href="#cb68-49"></a>p.values<span class="fl">.2</span>[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x2,<span class="dt">y=</span>y2,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb68-50"><a href="#cb68-50"></a>}</span>
<span id="cb68-51"><a href="#cb68-51"></a></span>
<span id="cb68-52"><a href="#cb68-52"></a><span class="co"># case3: Non-normal distributions</span></span>
<span id="cb68-53"><a href="#cb68-53"></a><span class="co"># t </span></span>
<span id="cb68-54"><a href="#cb68-54"></a>p.values.<span class="fl">3.1</span> &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-55"><a href="#cb68-55"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-56"><a href="#cb68-56"></a>x3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p);</span>
<span id="cb68-57"><a href="#cb68-57"></a>y3&lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">1</span>),<span class="kw">rt</span>(n2,<span class="dt">df=</span><span class="dv">1</span>));</span>
<span id="cb68-58"><a href="#cb68-58"></a>z3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x3,y3)</span>
<span id="cb68-59"><a href="#cb68-59"></a>p.values.<span class="fl">3.1</span>[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z3,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-60"><a href="#cb68-60"></a>p.values.<span class="fl">3.1</span>[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z3,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-61"><a href="#cb68-61"></a>p.values.<span class="fl">3.1</span>[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y3,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb68-62"><a href="#cb68-62"></a>}</span>
<span id="cb68-63"><a href="#cb68-63"></a><span class="co"># bimodel  X \sim 0.5*N(0,1) + 0.5*N(0,4) Y\sim 0.5*N(0,1) + 0.5* N(0,16)</span></span>
<span id="cb68-64"><a href="#cb68-64"></a>p.values.<span class="fl">3.2</span> &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-65"><a href="#cb68-65"></a>temp &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb68-66"><a href="#cb68-66"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-67"><a href="#cb68-67"></a>u &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb68-68"><a href="#cb68-68"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb68-69"><a href="#cb68-69"></a>  <span class="cf">if</span>(u[j]<span class="op">==</span><span class="dv">0</span>) temp[j] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb68-70"><a href="#cb68-70"></a>  <span class="cf">else</span> temp[j] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">2</span>)</span>
<span id="cb68-71"><a href="#cb68-71"></a>}</span>
<span id="cb68-72"><a href="#cb68-72"></a>x3 &lt;-<span class="st"> </span><span class="kw">matrix</span>(temp,<span class="dt">ncol=</span>p);</span>
<span id="cb68-73"><a href="#cb68-73"></a>v &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb68-74"><a href="#cb68-74"></a><span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb68-75"><a href="#cb68-75"></a>  <span class="cf">if</span>(v[l]<span class="op">==</span><span class="dv">0</span>) temp[l] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb68-76"><a href="#cb68-76"></a>  <span class="cf">else</span> temp[l] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">4</span>)</span>
<span id="cb68-77"><a href="#cb68-77"></a>}</span>
<span id="cb68-78"><a href="#cb68-78"></a>y3&lt;-<span class="st"> </span><span class="kw">matrix</span>(temp,<span class="dt">ncol=</span>p);</span>
<span id="cb68-79"><a href="#cb68-79"></a>z3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x3,y3)</span>
<span id="cb68-80"><a href="#cb68-80"></a>p.values.<span class="fl">3.2</span>[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z3,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-81"><a href="#cb68-81"></a>p.values.<span class="fl">3.2</span>[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z3,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-82"><a href="#cb68-82"></a>p.values.<span class="fl">3.2</span>[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x3,<span class="dt">y=</span>y3,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb68-83"><a href="#cb68-83"></a>}</span>
<span id="cb68-84"><a href="#cb68-84"></a></span>
<span id="cb68-85"><a href="#cb68-85"></a><span class="co"># case 4: Unbalanced samples- consider 2-calssification problem</span></span>
<span id="cb68-86"><a href="#cb68-86"></a>p.values<span class="fl">.4</span> &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb68-87"><a href="#cb68-87"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb68-88"><a href="#cb68-88"></a>x4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="dv">10</span><span class="op">/</span><span class="dv">11</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb68-89"><a href="#cb68-89"></a>y4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="dv">10</span><span class="op">/</span><span class="dv">11</span>),<span class="dt">ncol=</span>p)</span>
<span id="cb68-90"><a href="#cb68-90"></a>z4 &lt;-<span class="st"> </span><span class="kw">rbind</span>(x4,y4)</span>
<span id="cb68-91"><a href="#cb68-91"></a>p.values<span class="fl">.4</span>[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z4,N,k)<span class="op">$</span>p.value</span>
<span id="cb68-92"><a href="#cb68-92"></a>p.values<span class="fl">.4</span>[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z4,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb68-93"><a href="#cb68-93"></a>p.values<span class="fl">.4</span>[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x4,<span class="dt">y=</span>y4,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value</span>
<span id="cb68-94"><a href="#cb68-94"></a>}</span>
<span id="cb68-95"><a href="#cb68-95"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb68-96"><a href="#cb68-96"></a>col_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>,<span class="st">&quot;energy&quot;</span>,<span class="st">&quot;Ball&quot;</span>)</span>
<span id="cb68-97"><a href="#cb68-97"></a>row_names &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;case1&quot;</span>,<span class="st">&quot;case2&quot;</span>,<span class="st">&quot;case 3-1&quot;</span>,<span class="st">&quot;case 3-2&quot;</span>,<span class="st">&quot;case 4&quot;</span>)</span>
<span id="cb68-98"><a href="#cb68-98"></a></span>
<span id="cb68-99"><a href="#cb68-99"></a>pow &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dt">dimnames=</span><span class="kw">list</span>(row_names,col_names))</span>
<span id="cb68-100"><a href="#cb68-100"></a>pow[<span class="dv">1</span>,] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="fl">.1</span><span class="op">&lt;</span>alpha)</span>
<span id="cb68-101"><a href="#cb68-101"></a>pow[<span class="dv">2</span>,] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="fl">.2</span><span class="op">&lt;</span>alpha)</span>
<span id="cb68-102"><a href="#cb68-102"></a>pow[<span class="dv">3</span>,] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values.<span class="fl">3.1</span><span class="op">&lt;</span>alpha)</span>
<span id="cb68-103"><a href="#cb68-103"></a>pow[<span class="dv">4</span>,] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values.<span class="fl">3.2</span><span class="op">&lt;</span>alpha)</span>
<span id="cb68-104"><a href="#cb68-104"></a>pow[<span class="dv">5</span>,] &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="fl">.4</span><span class="op">&lt;</span>alpha)</span>
<span id="cb68-105"><a href="#cb68-105"></a></span>
<span id="cb68-106"><a href="#cb68-106"></a></span>
<span id="cb68-107"><a href="#cb68-107"></a><span class="kw">kable</span>(pow, <span class="st">&quot;html&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb68-108"><a href="#cb68-108"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">full_width =</span> F,  <span class="dt">position =</span> <span class="st">&quot;left&quot;</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; ">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
NN
</th>
<th style="text-align:right;">
energy
</th>
<th style="text-align:right;">
Ball
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
case1
</td>
<td style="text-align:right;">
0.945
</td>
<td style="text-align:right;">
0.995
</td>
<td style="text-align:right;">
0.998
</td>
</tr>
<tr>
<td style="text-align:left;">
case2
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
case 3-1
</td>
<td style="text-align:right;">
0.076
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.076
</td>
</tr>
<tr>
<td style="text-align:left;">
case 3-2
</td>
<td style="text-align:right;">
0.445
</td>
<td style="text-align:right;">
0.736
</td>
<td style="text-align:right;">
0.909
</td>
</tr>
<tr>
<td style="text-align:left;">
case 4
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
0.114
</td>
<td style="text-align:right;">
0.092
</td>
</tr>
</tbody>
</table>
<p>The result shows that when rejected <span class="math inline">\(H_0\)</span>, the power energy method an Ball method is larger while small when accepted <span class="math inline">\(H_0\)</span>, which means that Ball method has best performance, the next is energy method, the last is NN method.</p>
</div>
<div id="section-10" class="section level2">
<h2>2020/11/17</h2>
</div>
<div id="q1-ex-9.4" class="section level2">
<h2>Q1: Ex 9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<p>The density of Laplace distribution is given by <span class="math display">\[ f(x)=\frac{1}{2}\exp\{-|x|\},x\in\mathbf{R}.\]</span> The codes are shown as following:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb69-2"><a href="#cb69-2"></a>denLaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb69-3"><a href="#cb69-3"></a>  <span class="kw">return</span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x)))</span>
<span id="cb69-4"><a href="#cb69-4"></a>}</span>
<span id="cb69-5"><a href="#cb69-5"></a></span>
<span id="cb69-6"><a href="#cb69-6"></a>RW.MSample &lt;-<span class="st"> </span><span class="cf">function</span>(N,sigma,x0) {</span>
<span id="cb69-7"><a href="#cb69-7"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb69-8"><a href="#cb69-8"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb69-9"><a href="#cb69-9"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb69-10"><a href="#cb69-10"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb69-11"><a href="#cb69-11"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb69-12"><a href="#cb69-12"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb69-13"><a href="#cb69-13"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">denLaplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">denLaplace</span>(x[i<span class="dv">-1</span>]))){</span>
<span id="cb69-14"><a href="#cb69-14"></a>      x[i] &lt;-<span class="st"> </span>y</span>
<span id="cb69-15"><a href="#cb69-15"></a>    }</span>
<span id="cb69-16"><a href="#cb69-16"></a>    <span class="cf">else</span> {</span>
<span id="cb69-17"><a href="#cb69-17"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb69-18"><a href="#cb69-18"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb69-19"><a href="#cb69-19"></a>      } </span>
<span id="cb69-20"><a href="#cb69-20"></a>    }</span>
<span id="cb69-21"><a href="#cb69-21"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb69-22"><a href="#cb69-22"></a>}</span>
<span id="cb69-23"><a href="#cb69-23"></a></span>
<span id="cb69-24"><a href="#cb69-24"></a><span class="co"># start</span></span>
<span id="cb69-25"><a href="#cb69-25"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb69-26"><a href="#cb69-26"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">10</span>)</span>
<span id="cb69-27"><a href="#cb69-27"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb69-28"><a href="#cb69-28"></a>RW1 &lt;-<span class="st"> </span><span class="kw">RW.MSample</span>(N,sigma[<span class="dv">1</span>], x0)</span>
<span id="cb69-29"><a href="#cb69-29"></a>RW2 &lt;-<span class="st"> </span><span class="kw">RW.MSample</span>(N,sigma[<span class="dv">2</span>], x0)</span>
<span id="cb69-30"><a href="#cb69-30"></a>RW3 &lt;-<span class="st"> </span><span class="kw">RW.MSample</span>(N,sigma[<span class="dv">3</span>], x0)</span>
<span id="cb69-31"><a href="#cb69-31"></a>RW4 &lt;-<span class="st"> </span><span class="kw">RW.MSample</span>(N,sigma[<span class="dv">4</span>], x0)</span>
<span id="cb69-32"><a href="#cb69-32"></a></span>
<span id="cb69-33"><a href="#cb69-33"></a><span class="kw">print</span>(<span class="kw">c</span>((<span class="dv">2000</span><span class="op">-</span>RW1<span class="op">$</span>k)<span class="op">/</span><span class="dv">2000</span>, (<span class="dv">2000</span><span class="op">-</span>RW2<span class="op">$</span>k)<span class="op">/</span><span class="dv">2000</span>, (<span class="dv">2000</span><span class="op">-</span>RW4<span class="op">$</span>k)<span class="op">/</span><span class="dv">2000</span>, (<span class="dv">2000</span><span class="op">-</span>RW4<span class="op">$</span>k)<span class="op">/</span><span class="dv">2000</span>))</span></code></pre></div>
<pre><code>## [1] 0.9795 0.8305 0.1420 0.1420</code></pre>
</div>
<div id="q2" class="section level2">
<h2>Q2:</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\widehat{R}&lt; 1.2\)</span>.</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># set.seed(11)</span></span>
<span id="cb71-2"><a href="#cb71-2"></a><span class="co"># Gelman.Rubin &lt;- function(psi) {</span></span>
<span id="cb71-3"><a href="#cb71-3"></a><span class="co"># # psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="co"># # for chain in i-th row of X</span></span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="co">#   psi &lt;- as.matrix(psi)</span></span>
<span id="cb71-6"><a href="#cb71-6"></a><span class="co">#   n &lt;- ncol(psi)</span></span>
<span id="cb71-7"><a href="#cb71-7"></a><span class="co">#   psi.means &lt;- rowMeans(psi) #row means</span></span>
<span id="cb71-8"><a href="#cb71-8"></a><span class="co">#   B &lt;- n * var(psi.means) #between variance est.</span></span>
<span id="cb71-9"><a href="#cb71-9"></a><span class="co">#   psi.w &lt;- apply(psi, 1, &quot;var&quot;) #within variances</span></span>
<span id="cb71-10"><a href="#cb71-10"></a><span class="co">#   W &lt;- mean(psi.w) #within est.</span></span>
<span id="cb71-11"><a href="#cb71-11"></a><span class="co">#   v.hat &lt;- W*(n-1)/n + (B/n) #upper variance est.</span></span>
<span id="cb71-12"><a href="#cb71-12"></a><span class="co">#   r.hat &lt;- v.hat / W #G-R statistic</span></span>
<span id="cb71-13"><a href="#cb71-13"></a><span class="co">#   return(r.hat)</span></span>
<span id="cb71-14"><a href="#cb71-14"></a><span class="co"># }</span></span>
<span id="cb71-15"><a href="#cb71-15"></a><span class="co"># denLaplace&lt;-function(x){</span></span>
<span id="cb71-16"><a href="#cb71-16"></a><span class="co">#   return(0.5*exp(-abs(x)))</span></span>
<span id="cb71-17"><a href="#cb71-17"></a><span class="co"># }</span></span>
<span id="cb71-18"><a href="#cb71-18"></a><span class="co"># </span></span>
<span id="cb71-19"><a href="#cb71-19"></a><span class="co"># RW.MSample &lt;- function(N,sigma,x0) {</span></span>
<span id="cb71-20"><a href="#cb71-20"></a><span class="co">#   x &lt;- numeric(N)</span></span>
<span id="cb71-21"><a href="#cb71-21"></a><span class="co">#   x[1] &lt;- x0</span></span>
<span id="cb71-22"><a href="#cb71-22"></a><span class="co">#   u &lt;- runif(N)</span></span>
<span id="cb71-23"><a href="#cb71-23"></a><span class="co">#   k &lt;- 0</span></span>
<span id="cb71-24"><a href="#cb71-24"></a><span class="co">#   for (i in 2:N) {</span></span>
<span id="cb71-25"><a href="#cb71-25"></a><span class="co">#     y &lt;- rnorm(1, x[i-1], sigma)</span></span>
<span id="cb71-26"><a href="#cb71-26"></a><span class="co">#     if (u[i] &lt;= (denLaplace(y) / denLaplace(x[i-1]))){</span></span>
<span id="cb71-27"><a href="#cb71-27"></a><span class="co">#       x[i] &lt;- y</span></span>
<span id="cb71-28"><a href="#cb71-28"></a><span class="co">#     }</span></span>
<span id="cb71-29"><a href="#cb71-29"></a><span class="co">#     else {</span></span>
<span id="cb71-30"><a href="#cb71-30"></a><span class="co">#       x[i] &lt;- x[i-1]</span></span>
<span id="cb71-31"><a href="#cb71-31"></a><span class="co">#       k &lt;- k + 1</span></span>
<span id="cb71-32"><a href="#cb71-32"></a><span class="co">#       } </span></span>
<span id="cb71-33"><a href="#cb71-33"></a><span class="co">#     }</span></span>
<span id="cb71-34"><a href="#cb71-34"></a><span class="co">#   return(list(x=x, k=k))</span></span>
<span id="cb71-35"><a href="#cb71-35"></a><span class="co"># }</span></span>
<span id="cb71-36"><a href="#cb71-36"></a><span class="co"># </span></span>
<span id="cb71-37"><a href="#cb71-37"></a><span class="co"># </span></span>
<span id="cb71-38"><a href="#cb71-38"></a><span class="co"># sigma &lt;- sqrt(2) #parameter of proposal distribution</span></span>
<span id="cb71-39"><a href="#cb71-39"></a><span class="co"># k &lt;- 4 #number of chains to generate</span></span>
<span id="cb71-40"><a href="#cb71-40"></a><span class="co"># n &lt;- 10000 #length of chains</span></span>
<span id="cb71-41"><a href="#cb71-41"></a><span class="co"># b &lt;- 500 #burn-in length</span></span>
<span id="cb71-42"><a href="#cb71-42"></a><span class="co"># </span></span>
<span id="cb71-43"><a href="#cb71-43"></a><span class="co"># x0 &lt;- c(-10, -5, 5, 10)</span></span>
<span id="cb71-44"><a href="#cb71-44"></a><span class="co"># </span></span>
<span id="cb71-45"><a href="#cb71-45"></a><span class="co"># #generate the chains</span></span>
<span id="cb71-46"><a href="#cb71-46"></a><span class="co"># X &lt;- matrix(0, nrow=k, ncol=n)</span></span>
<span id="cb71-47"><a href="#cb71-47"></a><span class="co"># for (i in 1:k)</span></span>
<span id="cb71-48"><a href="#cb71-48"></a><span class="co">#   X[i, ] &lt;- RW.MSample(n, sigma, x0[i])$x</span></span>
<span id="cb71-49"><a href="#cb71-49"></a><span class="co"># </span></span>
<span id="cb71-50"><a href="#cb71-50"></a><span class="co"># #compute diagnostic statistics</span></span>
<span id="cb71-51"><a href="#cb71-51"></a><span class="co"># psi &lt;- t(apply(X, 1, cumsum))</span></span>
<span id="cb71-52"><a href="#cb71-52"></a><span class="co"># for (i in 1:nrow(psi))</span></span>
<span id="cb71-53"><a href="#cb71-53"></a><span class="co">#   psi[i,] &lt;- psi[i,] / (1:ncol(psi))</span></span>
<span id="cb71-54"><a href="#cb71-54"></a><span class="co"># print(Gelman.Rubin(psi))</span></span>
<span id="cb71-55"><a href="#cb71-55"></a><span class="co"># # plot</span></span>
<span id="cb71-56"><a href="#cb71-56"></a><span class="co"># par(mfrow=c(2,2))</span></span>
<span id="cb71-57"><a href="#cb71-57"></a><span class="co"># for (i in 1:k)</span></span>
<span id="cb71-58"><a href="#cb71-58"></a><span class="co">#   plot(psi[i, (b+1):n], type=&quot;l&quot;,xlab=i, ylab=bquote(psi))</span></span></code></pre></div>
</div>
<div id="q3-ex-11.4" class="section level2">
<h2>Q3: Ex 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)\]</span> and <span class="math display">\[S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^2 k}{k+1-a^2}}\right),\]</span> for <span class="math inline">\(k=4:25,100,500,1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student t random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span>-test for scale-mixture errors proposed by Szekely [260].)</p>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>root&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)) {</span>
<span id="cb72-4"><a href="#cb72-4"></a>  res &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){</span>
<span id="cb72-5"><a href="#cb72-5"></a>    <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i]<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k[i]<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k[i]<span class="op">-</span><span class="dv">1</span>,<span class="dt">log.p =</span> T)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k[i])<span class="op">/</span>(k[i]<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k[i],<span class="dt">log.p =</span> T)</span>
<span id="cb72-6"><a href="#cb72-6"></a>  },<span class="dt">lower =</span> <span class="fl">1e-5</span>,<span class="dt">upper =</span> <span class="kw">sqrt</span>(k[i]<span class="op">-</span><span class="fl">1e-5</span>))</span>
<span id="cb72-7"><a href="#cb72-7"></a>  root[i]&lt;-<span class="kw">unlist</span>(res)[[<span class="dv">1</span>]]</span>
<span id="cb72-8"><a href="#cb72-8"></a>}</span>
<span id="cb72-9"><a href="#cb72-9"></a>root</span></code></pre></div>
<pre><code>##  [1]  1.492105  1.533562  1.562745  1.584430  1.601183  1.614517  1.625384
##  [8]  1.634410  1.642054  1.648550  1.654175  1.659110  1.663444  1.667306
## [15]  1.670705  1.673817  1.676644  1.679131  1.681458  1.683590  1.685545
## [22]  1.687350  1.720619 22.360680 31.622776</code></pre>
</div>
<div id="section-11" class="section level2">
<h2>2020/11/24</h2>
</div>
<div id="q1a-b-o-boold-type-problem" class="section level2">
<h2>Q1:A-B-O boold type problem</h2>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>From the table, we know that <span class="math inline">\(p+q+r=1,p,q,r \in (0,1)\)</span>. The observed data likelihood <span class="math display">\[L(p,q\mid n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=(p^2+2p(1-p-q))^{n_{A\cdot}}(q^2+2q(1-p-q))^{n_{B\cdot}}((1-p-q)^2)^{n_{OO}}(2pq)^{n_{AB}},\]</span> the logarithmic likelihood is given by <span class="math display">\[\ell(p,q\mid n_{A\cdot},n_{B\cdot},n_{OO},n_{AB})=n_{A\cdot}\log(p^2+2p(1-p-q))+n_{B\cdot}\log(q^2+2q(1-p-q))+2n_{OO}\log(1-p-q)+n_{AB}\log(2pq),\]</span> Let <span class="math inline">\(\frac{\partial \ell}{\partial p}=0,\frac{\partial \ell}{\partial q}=0\)</span>, then <span class="math inline">\(\widehat{p},\widehat{q}\)</span> are obtained.</p>
<p>Complete data likelihood <span class="math display">\[L(p,q\mid n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})=(p^2)^{n_{AA}}(q^2)^{n_{BB}}(r^2)^{n_{OO}}(2pr)^{n_{AO}}(2qr)^{n_{BO}}(2pq)^{n_{AB}},\]</span> the logarithmic likelihood <span class="math display">\[I(p,q\mid n_{AA},n_{BB},n_{OO},n_{AO},n_{BO},n_{AB})=2n_{AA}\log(p)+2n_{BB}\log(q)+2n_{OO}\log(r)+n_{AO}\log(2pr)+n_{BO}\log(2qr)+n_{AB}\log(2pq).\]</span> <span class="math inline">\(n_{AA}\mid n_{AO},n_{A\cdot}\sim B(n_{A\cdot},\frac{p^2}{p^2+2pr}),n_{BB}\mid n_{BO},n_{B\cdot}\sim B(n_{B\cdot},\frac{q^2}{q^2+2qr})\)</span></p>
<p>E-step, <span class="math display">\[\begin{align}
E(I\mid n_{AA}n_{BB})=2n_{A\cdot} \frac{p^2}{p^2+2pr}\log(p)+2n_{B\cdot}\frac{q^2}{q^2+2qr}\log(q)+2n_{OO}\log(r)+n_{AO}\log(2pr)+n_{BO}\log(2qr)+n_{AB}\log(2pq)
\end{align}\]</span></p>
<p>M-step,</p>
<p>use <span class="math inline">\(n_{A\cdot} \frac{p^2}{p^2+2pr},n_{B\cdot}\frac{q^2}{q^2+2qr}\)</span> to replace <span class="math inline">\(n_{AA},n_{BB}\)</span> in complete data likelihood, then maximizing it.</p>
<p>Do E-step and M-step interactively until it converges. The code is given by</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="co"># complete data likelihood</span></span>
<span id="cb74-2"><a href="#cb74-2"></a>Clikelihood &lt;-<span class="st"> </span><span class="cf">function</span>(pq,nAA,nBB){</span>
<span id="cb74-3"><a href="#cb74-3"></a>  <span class="co"># pq is a vector contains p and q</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>  <span class="co"># data</span></span>
<span id="cb74-5"><a href="#cb74-5"></a>  p&lt;-<span class="st"> </span>pq[<span class="dv">1</span>]</span>
<span id="cb74-6"><a href="#cb74-6"></a>  q&lt;-<span class="st"> </span>pq[<span class="dv">2</span>]</span>
<span id="cb74-7"><a href="#cb74-7"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb74-8"><a href="#cb74-8"></a>  </span>
<span id="cb74-9"><a href="#cb74-9"></a>  nA. &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb74-10"><a href="#cb74-10"></a>  nB. &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb74-11"><a href="#cb74-11"></a>  nOO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb74-12"><a href="#cb74-12"></a>  nAB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb74-13"><a href="#cb74-13"></a>  nAO &lt;-<span class="st"> </span>nA. <span class="op">-</span><span class="st"> </span>nAA</span>
<span id="cb74-14"><a href="#cb74-14"></a>  nBO &lt;-<span class="st"> </span>nB. <span class="op">-</span><span class="st"> </span>nBB</span>
<span id="cb74-15"><a href="#cb74-15"></a>  </span>
<span id="cb74-16"><a href="#cb74-16"></a>  fx1 &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>nAA<span class="op">*</span><span class="kw">log</span>(p)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nBB<span class="op">*</span><span class="kw">log</span>(q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)</span>
<span id="cb74-17"><a href="#cb74-17"></a>  fx2 &lt;-<span class="st"> </span>nAO<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nBO<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</span>
<span id="cb74-18"><a href="#cb74-18"></a>  fx &lt;-<span class="st"> </span>fx1 <span class="op">+</span><span class="st"> </span>fx2</span>
<span id="cb74-19"><a href="#cb74-19"></a>  <span class="kw">return</span>(<span class="op">-</span>fx)</span>
<span id="cb74-20"><a href="#cb74-20"></a>}</span>
<span id="cb74-21"><a href="#cb74-21"></a></span>
<span id="cb74-22"><a href="#cb74-22"></a><span class="co"># gradient for llikelihood</span></span>
<span id="cb74-23"><a href="#cb74-23"></a>DLikelihood &lt;-<span class="st"> </span><span class="cf">function</span>(pq,nAA,nBB){</span>
<span id="cb74-24"><a href="#cb74-24"></a>  p&lt;-<span class="st"> </span>pq[<span class="dv">1</span>]</span>
<span id="cb74-25"><a href="#cb74-25"></a>  q&lt;-<span class="st"> </span>pq[<span class="dv">2</span>]</span>
<span id="cb74-26"><a href="#cb74-26"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb74-27"><a href="#cb74-27"></a>  </span>
<span id="cb74-28"><a href="#cb74-28"></a>  nA. &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb74-29"><a href="#cb74-29"></a>  nB. &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb74-30"><a href="#cb74-30"></a>  nOO &lt;-<span class="st"> </span><span class="dv">361</span></span>
<span id="cb74-31"><a href="#cb74-31"></a>  nAB &lt;-<span class="st"> </span><span class="dv">63</span></span>
<span id="cb74-32"><a href="#cb74-32"></a>  nAO &lt;-<span class="st"> </span>nA. <span class="op">-</span><span class="st"> </span>nAA</span>
<span id="cb74-33"><a href="#cb74-33"></a>  nBO &lt;-<span class="st"> </span>nB. <span class="op">-</span><span class="st"> </span>nBB</span>
<span id="cb74-34"><a href="#cb74-34"></a>  </span>
<span id="cb74-35"><a href="#cb74-35"></a>  Dfx1 &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nAA<span class="op">+</span>nAO<span class="op">+</span>nAB)<span class="op">/</span>p <span class="op">-</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nOO<span class="op">+</span>nAO<span class="op">+</span>nBO)<span class="op">/</span>r</span>
<span id="cb74-36"><a href="#cb74-36"></a>  Dfx2 &lt;-<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nBB<span class="op">+</span>nBO<span class="op">+</span>nAB)<span class="op">/</span>q <span class="op">-</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>nOO<span class="op">+</span>nAO<span class="op">+</span>nBO)<span class="op">/</span>r</span>
<span id="cb74-37"><a href="#cb74-37"></a>  Dfx  &lt;-<span class="st"> </span><span class="kw">c</span>(Dfx1, Dfx2)</span>
<span id="cb74-38"><a href="#cb74-38"></a>  <span class="kw">return</span>(<span class="op">-</span>Dfx)</span>
<span id="cb74-39"><a href="#cb74-39"></a>}</span>
<span id="cb74-40"><a href="#cb74-40"></a><span class="co"># calculate M-step</span></span>
<span id="cb74-41"><a href="#cb74-41"></a>Mstep &lt;-<span class="st"> </span><span class="cf">function</span>(pq){</span>
<span id="cb74-42"><a href="#cb74-42"></a>  p &lt;-<span class="st"> </span>pq[<span class="dv">1</span>]</span>
<span id="cb74-43"><a href="#cb74-43"></a>  q &lt;-<span class="st"> </span>pq[<span class="dv">2</span>]</span>
<span id="cb74-44"><a href="#cb74-44"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb74-45"><a href="#cb74-45"></a>  nA. &lt;-<span class="st"> </span><span class="dv">444</span></span>
<span id="cb74-46"><a href="#cb74-46"></a>  nB. &lt;-<span class="st"> </span><span class="dv">132</span></span>
<span id="cb74-47"><a href="#cb74-47"></a>  p0 &lt;-<span class="st"> </span>p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)</span>
<span id="cb74-48"><a href="#cb74-48"></a>  q0 &lt;-<span class="st"> </span>q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)</span>
<span id="cb74-49"><a href="#cb74-49"></a>  x &lt;-<span class="st"> </span>nA.<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p0)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>p0)</span>
<span id="cb74-50"><a href="#cb74-50"></a>  y &lt;-<span class="st"> </span>nB.<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q0)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>q0)</span>
<span id="cb74-51"><a href="#cb74-51"></a>  <span class="kw">return</span>(<span class="kw">c</span>(x,y))</span>
<span id="cb74-52"><a href="#cb74-52"></a>}</span>
<span id="cb74-53"><a href="#cb74-53"></a></span>
<span id="cb74-54"><a href="#cb74-54"></a></span>
<span id="cb74-55"><a href="#cb74-55"></a><span class="co"># initial value</span></span>
<span id="cb74-56"><a href="#cb74-56"></a>pq0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.2</span>)</span>
<span id="cb74-57"><a href="#cb74-57"></a></span>
<span id="cb74-58"><a href="#cb74-58"></a>Mtemp &lt;-<span class="st"> </span><span class="kw">Mstep</span>(pq0)</span>
<span id="cb74-59"><a href="#cb74-59"></a>nAA &lt;-<span class="st"> </span>Mtemp[<span class="dv">1</span>]</span>
<span id="cb74-60"><a href="#cb74-60"></a>nBB &lt;-<span class="st"> </span>Mtemp[<span class="dv">2</span>]</span>
<span id="cb74-61"><a href="#cb74-61"></a></span>
<span id="cb74-62"><a href="#cb74-62"></a>Ltemp &lt;-<span class="st"> </span><span class="kw">optim</span>(pq0,Clikelihood,<span class="dt">gr=</span>DLikelihood,<span class="dt">nAA=</span>nAA,<span class="dt">nBB=</span>nBB)</span>
<span id="cb74-63"><a href="#cb74-63"></a>pq1 &lt;-<span class="st"> </span>Ltemp[[<span class="dv">1</span>]]</span>
<span id="cb74-64"><a href="#cb74-64"></a></span>
<span id="cb74-65"><a href="#cb74-65"></a><span class="co"># star</span></span>
<span id="cb74-66"><a href="#cb74-66"></a><span class="cf">while</span> (<span class="kw">sum</span>(<span class="kw">abs</span>(pq1<span class="op">-</span>pq0))<span class="op">&gt;</span><span class="fl">1e-5</span>) {</span>
<span id="cb74-67"><a href="#cb74-67"></a>  pq0 &lt;-<span class="st"> </span>pq1</span>
<span id="cb74-68"><a href="#cb74-68"></a>  Mtemp &lt;-<span class="st"> </span><span class="kw">Mstep</span>(pq0)</span>
<span id="cb74-69"><a href="#cb74-69"></a>  nAA &lt;-<span class="st"> </span>Mtemp[<span class="dv">1</span>]</span>
<span id="cb74-70"><a href="#cb74-70"></a>  nBB &lt;-<span class="st"> </span>Mtemp[<span class="dv">2</span>]</span>
<span id="cb74-71"><a href="#cb74-71"></a>  Ltemp &lt;-<span class="st"> </span><span class="kw">optim</span>(pq0,Clikelihood,<span class="dt">gr=</span>DLikelihood,<span class="dt">nAA=</span>nAA,<span class="dt">nBB=</span>nBB)</span>
<span id="cb74-72"><a href="#cb74-72"></a>  pq1 &lt;-<span class="st"> </span>Ltemp[[<span class="dv">1</span>]]</span>
<span id="cb74-73"><a href="#cb74-73"></a>  like &lt;-<span class="st"> </span><span class="kw">Clikelihood</span>(pq1,nAA,nBB)</span>
<span id="cb74-74"><a href="#cb74-74"></a>  <span class="kw">print</span>(<span class="op">-</span>like)</span>
<span id="cb74-75"><a href="#cb74-75"></a>}</span></code></pre></div>
<pre><code>## [1] -1817.29
## [1] -1803.47
## [1] -1807.129
## [1] -1806.164
## [1] -1806.445
## [1] -1806.374</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="co"># the  are shown as follow.</span></span></code></pre></div>
<p>They are increasing in general except at some points they will fluctuate.</p>
</div>
<div id="q2-1" class="section level2">
<h2>Q2:</h2>
<p>Use both for loops and <span class="math inline">\(lapply()\)</span> to fit linear models to the <span class="math inline">\(mtcars\)</span> using the formulas stored in the list</p>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>data &lt;-<span class="st"> </span>mtcars</span>
<span id="cb77-2"><a href="#cb77-2"></a></span>
<span id="cb77-3"><a href="#cb77-3"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb77-4"><a href="#cb77-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb77-5"><a href="#cb77-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb77-6"><a href="#cb77-6"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb77-7"><a href="#cb77-7"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb77-8"><a href="#cb77-8"></a>)</span>
<span id="cb77-9"><a href="#cb77-9"></a></span>
<span id="cb77-10"><a href="#cb77-10"></a>looplist &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">4</span>)</span>
<span id="cb77-11"><a href="#cb77-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(formulas)) {</span>
<span id="cb77-12"><a href="#cb77-12"></a>  looplist[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]],data)</span>
<span id="cb77-13"><a href="#cb77-13"></a>}</span>
<span id="cb77-14"><a href="#cb77-14"></a>looplist</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = data)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = data)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = data)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>lapplylist &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm,<span class="dt">data=</span>data)</span>
<span id="cb79-2"><a href="#cb79-2"></a>lapplylist</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="q3" class="section level2">
<h2>Q3:</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use <span class="math inline">\(sapply()\)</span> and an anonymous function to extract the p-value from every trial.</p>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb81-2"><a href="#cb81-2"></a><span class="dv">100</span>,</span>
<span id="cb81-3"><a href="#cb81-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb81-4"><a href="#cb81-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb81-5"><a href="#cb81-5"></a>)</span>
<span id="cb81-6"><a href="#cb81-6"></a></span>
<span id="cb81-7"><a href="#cb81-7"></a><span class="kw">sapply</span>(trials, <span class="cf">function</span>(i) i<span class="op">$</span>p.value)</span></code></pre></div>
<pre><code>##   [1] 0.472941265 0.487301667 0.659029056 0.928164488 0.537024586 0.237260061
##   [7] 0.837423628 0.492021720 0.254150176 0.334923324 0.683992176 0.640180607
##  [13] 0.092218386 0.054304899 0.544299227 0.384666670 0.178110813 0.866533100
##  [19] 0.477784023 0.264891524 0.456677016 0.198547053 0.478060367 0.701047967
##  [25] 0.239522031 0.342788854 0.340542261 0.117015423 0.443608109 0.969590370
##  [31] 0.509439481 0.314475419 0.411920419 0.071367077 0.622183348 0.775997362
##  [37] 0.465195494 0.395372639 0.388677518 0.211229842 0.280365996 0.827761281
##  [43] 0.205145216 0.622048880 0.989513105 0.230087425 0.543964305 0.085848525
##  [49] 0.079780571 0.022284674 0.653091573 0.522218449 0.645108486 0.711143097
##  [55] 0.982872575 0.659326916 0.503123585 0.159226606 0.787278482 0.675164363
##  [61] 0.133700095 0.488213325 0.282016419 0.073030975 0.370026218 0.930388646
##  [67] 0.498644591 0.783247586 0.294521717 0.938064359 0.502718110 0.896311512
##  [73] 0.859520160 0.727851177 0.602997681 0.882102002 0.305973717 0.079531884
##  [79] 0.002557052 0.878231026 0.008595398 0.068755016 0.942239984 0.678454778
##  [85] 0.694057192 0.654223852 0.703828775 0.468757206 0.157460784 0.259286571
##  [91] 0.545810917 0.928901031 0.907083972 0.933055180 0.762271294 0.870963347
##  [97] 0.361530552 0.758288144 0.166565369 0.466303339</code></pre>
</div>
<div id="q4" class="section level2">
<h2>Q4:</h2>
<p>Implement a combination of <span class="math inline">\(Map()\)</span> and <span class="math inline">\(vapply(\)</span>) to create an <span class="math inline">\(lapply()\)</span> variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<p>For a list of lists, apply <span class="math inline">\(lappy()\)</span></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>testlist &lt;-<span class="st"> </span><span class="kw">list</span>(iris, mtcars, cars)</span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="kw">lapply</span>(testlist, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): 参数不是数值也不是逻辑值：回覆NA</code></pre>
<pre><code>## [[1]]
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##     5.843333     3.057333     3.758000     1.199333           NA 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## speed  dist 
## 15.40 42.98</code></pre>
<p>It is equivalent to combinate <span class="math inline">\(Map()\)</span> and <span class="math inline">\(vapply()\)</span> as follows:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>mlapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){</span>
<span id="cb86-2"><a href="#cb86-2"></a>  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)</span>
<span id="cb86-3"><a href="#cb86-3"></a>  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}</span>
<span id="cb86-4"><a href="#cb86-4"></a>  out</span>
<span id="cb86-5"><a href="#cb86-5"></a>}</span>
<span id="cb86-6"><a href="#cb86-6"></a></span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="kw">mlapply</span>(testlist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): 参数不是数值也不是逻辑值：回覆NA</code></pre>
<pre><code>## [[1]]
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##     5.843333     3.057333     3.758000     1.199333           NA 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt       qsec 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 
##         vs         am       gear       carb 
##   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## speed  dist 
## 15.40 42.98</code></pre>
<p>The above result the two procedures have the same function.</p>
</div>
<div id="section-12" class="section level2">
<h2>2020/12/01</h2>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="kw">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
</div>
<div id="ex.-1" class="section level2">
<h2>Ex. 1</h2>
<p>Write an <span class="math inline">\(\text{Rcpp}\)</span> function for Exercise 9.4 (page 277, Statistical Computing with R)</p>
<p>Ex 9.4. Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="co"># library(StatComp20088)</span></span>
<span id="cb93-2"><a href="#cb93-2"></a><span class="co"># #library(Rcpp) </span></span>
<span id="cb93-3"><a href="#cb93-3"></a><span class="co"># #sourceCpp(&#39;RW.cpp&#39;)</span></span>
<span id="cb93-4"><a href="#cb93-4"></a><span class="co"># #test: rw=RWcpp(2,25,2000)</span></span>
<span id="cb93-5"><a href="#cb93-5"></a><span class="co"># set.seed(123)</span></span>
<span id="cb93-6"><a href="#cb93-6"></a><span class="co"># N &lt;- 2000</span></span>
<span id="cb93-7"><a href="#cb93-7"></a><span class="co"># sigma &lt;- c(.05, .5, 5, 50)</span></span>
<span id="cb93-8"><a href="#cb93-8"></a><span class="co"># x0 &lt;- 25</span></span>
<span id="cb93-9"><a href="#cb93-9"></a><span class="co"># rw1_c &lt;- RWcpp(sigma[1],x0,N)</span></span>
<span id="cb93-10"><a href="#cb93-10"></a><span class="co"># rw2_c &lt;- RWcpp(sigma[2],x0,N)</span></span>
<span id="cb93-11"><a href="#cb93-11"></a><span class="co"># rw3_c &lt;- RWcpp(sigma[3],x0,N)</span></span>
<span id="cb93-12"><a href="#cb93-12"></a><span class="co"># rw4_c &lt;- RWcpp(sigma[4],x0,N)</span></span>
<span id="cb93-13"><a href="#cb93-13"></a><span class="co"># #number of candidate points rejected</span></span>
<span id="cb93-14"><a href="#cb93-14"></a><span class="co"># reject &lt;- cbind(rw1_c$k, rw2_c$k, rw3_c$k, rw4_c$k)</span></span>
<span id="cb93-15"><a href="#cb93-15"></a><span class="co"># accept_rates &lt;- round((N-reject)/N,4)</span></span>
<span id="cb93-16"><a href="#cb93-16"></a><span class="co"># sigma &lt;- matrix(sigma,nrow = 1)</span></span>
<span id="cb93-17"><a href="#cb93-17"></a><span class="co"># mat &lt;- rbind(sigma,accept_rates)</span></span>
<span id="cb93-18"><a href="#cb93-18"></a><span class="co"># rownames(mat) &lt;- c(&quot;sigma&quot;,&quot;Acceptance rates&quot;)</span></span>
<span id="cb93-19"><a href="#cb93-19"></a><span class="co"># colnames(mat) &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;)</span></span>
<span id="cb93-20"><a href="#cb93-20"></a><span class="co"># knitr::kable(mat)</span></span>
<span id="cb93-21"><a href="#cb93-21"></a><span class="co"># </span></span>
<span id="cb93-22"><a href="#cb93-22"></a><span class="co"># #plot</span></span>
<span id="cb93-23"><a href="#cb93-23"></a><span class="co"># par(mfrow = c(2,2))  #display 4 graphs together</span></span>
<span id="cb93-24"><a href="#cb93-24"></a><span class="co"># rw &lt;- cbind(rw1_c$x,rw2_c$x, rw3_c$x,rw4_c$x)</span></span>
<span id="cb93-25"><a href="#cb93-25"></a><span class="co"># for (j in 1:4) {</span></span>
<span id="cb93-26"><a href="#cb93-26"></a><span class="co">#   plot(rw[,j], type=&quot;l&quot;,</span></span>
<span id="cb93-27"><a href="#cb93-27"></a><span class="co">#   xlab=bquote(sigma == .(round(sigma[j],3))),</span></span>
<span id="cb93-28"><a href="#cb93-28"></a><span class="co">#   ylab=&quot;X&quot;, ylim=range(rw[,j]))</span></span>
<span id="cb93-29"><a href="#cb93-29"></a><span class="co">#}</span></span></code></pre></div>
</div>
<div id="ex.-2" class="section level2">
<h2>Ex. 2</h2>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function <span class="math inline">\(“\text{qqplot}”\)</span>.</p>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co"># # R function for Ex. 9.4</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="co"># denLaplace &lt;- function(x){</span></span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="co">#   return(0.5*exp(-abs(x)))</span></span>
<span id="cb94-4"><a href="#cb94-4"></a><span class="co"># }</span></span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="co"># </span></span>
<span id="cb94-6"><a href="#cb94-6"></a><span class="co"># RW.MSample &lt;- function(N,sigma,x0) {</span></span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="co">#   x &lt;- numeric(N)</span></span>
<span id="cb94-8"><a href="#cb94-8"></a><span class="co">#   x[1] &lt;- x0</span></span>
<span id="cb94-9"><a href="#cb94-9"></a><span class="co">#   u &lt;- runif(N)</span></span>
<span id="cb94-10"><a href="#cb94-10"></a><span class="co">#   k &lt;- 0</span></span>
<span id="cb94-11"><a href="#cb94-11"></a><span class="co">#   for (i in 2:N) {</span></span>
<span id="cb94-12"><a href="#cb94-12"></a><span class="co">#     y &lt;- rnorm(1, x[i-1], sigma)</span></span>
<span id="cb94-13"><a href="#cb94-13"></a><span class="co">#     if (u[i] &lt;= (denLaplace(y) / denLaplace(x[i-1]))){</span></span>
<span id="cb94-14"><a href="#cb94-14"></a><span class="co">#       x[i] &lt;- y</span></span>
<span id="cb94-15"><a href="#cb94-15"></a><span class="co">#     }</span></span>
<span id="cb94-16"><a href="#cb94-16"></a><span class="co">#     else {</span></span>
<span id="cb94-17"><a href="#cb94-17"></a><span class="co">#       x[i] &lt;- x[i-1]</span></span>
<span id="cb94-18"><a href="#cb94-18"></a><span class="co">#       k &lt;- k + 1</span></span>
<span id="cb94-19"><a href="#cb94-19"></a><span class="co">#       } </span></span>
<span id="cb94-20"><a href="#cb94-20"></a><span class="co">#     }</span></span>
<span id="cb94-21"><a href="#cb94-21"></a><span class="co">#   return(list(x=x, k=k))</span></span>
<span id="cb94-22"><a href="#cb94-22"></a><span class="co"># }</span></span>
<span id="cb94-23"><a href="#cb94-23"></a><span class="co"># # by R function</span></span>
<span id="cb94-24"><a href="#cb94-24"></a><span class="co"># set.seed(12)</span></span>
<span id="cb94-25"><a href="#cb94-25"></a><span class="co"># N &lt;- 2000</span></span>
<span id="cb94-26"><a href="#cb94-26"></a><span class="co"># sigma &lt;- 1  # N(0,1)</span></span>
<span id="cb94-27"><a href="#cb94-27"></a><span class="co"># x0 &lt;- 0</span></span>
<span id="cb94-28"><a href="#cb94-28"></a><span class="co"># rw_R &lt;- RW.MSample(N,sigma, x0)</span></span>
<span id="cb94-29"><a href="#cb94-29"></a><span class="co"># rw_R &lt;- rw_R$x</span></span>
<span id="cb94-30"><a href="#cb94-30"></a><span class="co"># rw_R &lt;- rw_R[501:N]</span></span>
<span id="cb94-31"><a href="#cb94-31"></a><span class="co"># # by Rcpp </span></span>
<span id="cb94-32"><a href="#cb94-32"></a><span class="co"># rw_cpp &lt;- RWcpp(1,x0,N)</span></span>
<span id="cb94-33"><a href="#cb94-33"></a><span class="co"># rw_cpp &lt;- rw_cpp$x</span></span>
<span id="cb94-34"><a href="#cb94-34"></a><span class="co"># rw_cpp &lt;- rw_cpp[501:N]</span></span>
<span id="cb94-35"><a href="#cb94-35"></a><span class="co"># #plot qqplot</span></span>
<span id="cb94-36"><a href="#cb94-36"></a><span class="co"># Giao &lt;- ppoints(500)</span></span>
<span id="cb94-37"><a href="#cb94-37"></a><span class="co"># Quan_R &lt;- quantile(rw_R,Giao)</span></span>
<span id="cb94-38"><a href="#cb94-38"></a><span class="co"># Quan_cpp &lt;- quantile(rw_cpp,Giao)</span></span>
<span id="cb94-39"><a href="#cb94-39"></a><span class="co"># qqplot(Quan_R,Quan_cpp,main=&quot;&quot;,xlab=&quot;rw3 quantiles&quot;,ylab=&quot;rw3_c quantiles&quot;)</span></span>
<span id="cb94-40"><a href="#cb94-40"></a><span class="co"># qqline(Quan_cpp)</span></span></code></pre></div>
</div>
<div id="ex-.3" class="section level2">
<h2>Ex .3</h2>
<p>Campare the computation time of the two functions with the function <span class="math inline">\(“microbenchmark”\)</span>.</p>
</div>
<div id="answer-32" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="co"># microbenchmark(</span></span>
<span id="cb95-3"><a href="#cb95-3"></a><span class="co">#   RW.MSample(N,1, x0),</span></span>
<span id="cb95-4"><a href="#cb95-4"></a><span class="co">#   RWcpp(1,x0,N))</span></span></code></pre></div>
</div>
<div id="ex-4" class="section level2">
<h2>Ex 4</h2>
<p>Comments your results.</p>
</div>
<div id="answer-33" class="section level2">
<h2>Answer</h2>
<p><span class="math inline">\(\text{Rcpp}\)</span> can accelerate the computation in <span class="math inline">\(\text{R platform}\)</span> that address the critical issue of <span class="math inline">\(\text{R}\)</span>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
